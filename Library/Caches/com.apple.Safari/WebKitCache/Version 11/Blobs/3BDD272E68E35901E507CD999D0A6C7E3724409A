cw.prototype.D8=bP(59,function(){return Ru(this,3)});dD.prototype.D8=bP(58,function(){return Ru(this,5)});cw.prototype.f6=bP(57,function(){return V(this,3)});dD.prototype.f6=bP(56,function(){return V(this,5)});cw.prototype.H8=bP(55,function(){return Ru(this,2)});dD.prototype.H8=bP(54,function(){return Ru(this,4)});cw.prototype.s6=bP(53,function(){return V(this,2)});dD.prototype.s6=bP(52,function(){return V(this,4)});function RNd(a,b){ag(a,11,b)}function SNd(a,b,c){return"r"==c?znb(a,b):Anb(a,b)}
function TNd(a,b){return(a=KR(a,b))?a.rect:null}function UNd(a,b){a.D=b}function VNd(a){a.Fc("hl","en");return a}function WNd(a,b,c){c=void 0===c?!0:c;Ip.call(this,"docs-material-dialog",a,b);Xp(this,null);Wp(this,!0);Sp(this,this.iK?0:.6);this.O=new PR("Ok");this.Ia(this.O);(this.C=c?new QR("Cancel"):null)&&this.Ia(this.C)}q(WNd,Ip);p=WNd.prototype;
p.Ja=function(){var a=this;Ip.prototype.Ja.call(this);this.getHandler().V(this.O,"action",function(){return a.c8()}).V(this.Pa(),"keypress",this.JJb);this.C&&this.getHandler().V(this.C,"action",function(){a.dispatchEvent("Ic")&&a.setVisible(!1)})};p.JJb=function(a){13==a.keyCode&&(a.target==NDa(this)||this.C&&a.target==this.C.getElement()?this.dispatchEvent("Ic")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.c8())};
p.c8=function(){this.dispatchEvent("Hc")&&this.setVisible(!1)};p.Da=function(){Ip.prototype.Da.call(this);var a=Qp(this);this.C&&this.C.render(a);this.O.render(a);L(a,!0);oq(NDa(this),YCc)};p.vz=function(a){Ip.prototype.vz.call(this,a);Sp(this,this.iK?0:.6)};function XNd(a){Xf(this,a,0,-1,null,null)}x(XNd,Wf);function YNd(a){Xf(this,a,0,-1,null,null)}x(YNd,Wf);var ZNd=/['()]/g;function $Nd(a){return"%"+a.charCodeAt(0).toString(16)}
function aOd(a){a=Nb(String(a));ZNd.lastIndex=0;return ZNd.test(a)?a.replace(ZNd,$Nd):a}function bOd(a){return a.Al()+Yb(a.C)}
function cOd(a){var b=P;var c=yq(""+O(a.e3b));c='<div class="docs-unsupportedofficefeatureswarning-content-header"><div class="docs-unsupportedofficefeatureswarning-content-header-warningtext">'+O(c)+'</div><div class="docs-unsupportedofficefeatureswarning-content-header-restorefiletext">';c=P(c+"The original file can be restored from version history</div></div>");var d='<div class="docs-unsupportedofficefeatureswarning-content-features-list">';a=a.ud;for(var e=a.length,f=0;f<e;f++)d+=P('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+
O({feature:xq(""+a[f])}.feature)+"</div>");d=P(d+"</div>");return b(c+d)};function r2(a,b,c,d){Ts.call(this,"docs-unsupportedofficefeatureswarning",void 0,d);this.Aa=b;this.Ea=c;this.J=new PR(this.kDa());this.Ia(this.J);this.C=null;this.B8()&&(this.C=new PR(this.xDa()),this.Ia(this.C));this.F=null;a.F&&Eh(H(),"docs-esdttfl")&&(this.F=new $P("warning-dialogs",!1,d),this.Ia(this.F));Xp(this,null);Wp(this,!1);this.vz(!1);this.Ci=!0}x(r2,Ts);p=r2.prototype;p.Ska=n("alertdialog");
p.Da=function(){r2.oa.Da.call(this);oq(this.Sb(),cOd,{ud:this.Aa,e3b:this.Ea},void 0);var a=Qp(this);this.F&&this.F.render(a);this.J.render(a);this.B8()&&this.C.render(a);L(a,!0);L(Pp(this),!1);hq(this,null);J(this.Pa(),this.wAa())};p.Ja=function(){var a=this;r2.oa.Ja.call(this);this.getHandler().V(this.J,"action",function(){return a.Mla()});this.B8()&&this.getHandler().V(this.C,"action",function(){a.setVisible(!1)})};p.Mla=function(){this.setVisible(!1)};p.B8=Pe;p.xDa=sa;function dOd(a,b,c,d,e,f){r2.call(this,a,b,c,d);this.L=!1;this.R=e;this.O=f}x(dOd,r2);p=dOd.prototype;p.wAa=n("docs-editconsentdialog");p.kDa=n("Continue Editing");p.B8=Qe;p.xDa=n("Cancel");p.Mla=function(){dOd.oa.Mla.call(this);this.L=!0;this.R.gc()};p.vm=function(){dOd.oa.vm.call(this);this.L||this.O.gc()};function eOd(a,b,c,d){r2.call(this,a,b,c,d)}x(eOd,r2);eOd.prototype.wAa=n("docs-unsupportedfeatureslistdialog");eOd.prototype.kDa=n("Ok");function fOd(a){return P('<input type="text" id="docs-copy-link" class="'+Q("docs-copy-link")+'" value="'+Q(a.link)+'" readonly="readonly">')};function s2(a,b,c,d){Ts.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ea="";this.F=b||null;this.Aa=c||new Nzb(a);this.R=null!=d?d:null;a=new Up;Zp(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Aa.C()&&Zp(a,{key:"copy-link",caption:"Copy Link"});Xp(this,a)}x(s2,Ts);p=s2.prototype;
p.Da=function(){s2.oa.Da.call(this);J(Rp(this),"copy-link-dialog");J(Yp(this.D,"done"),"copy-link-done-button");this.C=N(fOd,{link:this.Ea},void 0,this.va());Lh(this.C,"label","Link to this comment");this.Sb().appendChild(this.C);if(this.L=Yp(this.D,"copy-link")){var a=fe("DIV");J(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Pp(this));this.O=new Co(a);this.J=Eo("Link copied to clipboard.","info",!1,4E3)}null!==this.R&&(gi(this.jr(),"z-index",this.R),gi(Rp(this),"z-index",this.R+1))};
p.Ll=function(){s2.oa.Ll.call(this);this.F&&this.getHandler().V(this.F,"copy",this.fBa);this.C.focus();this.C.select()};p.vm=function(){s2.oa.vm.call(this);this.F&&this.getHandler().Oc(this.F,"copy",this.fBa)};p.Ja=function(){s2.oa.Ja.call(this);this.getHandler().V(this.C,"click",this.wTb);this.L&&this.getHandler().V(this.L,"click",this.Dnb)};p.cUb=function(a){this.Ea=a;this.C&&(this.C.value=a)};p.wTb=function(a){a.target.focus();a.target.select()};
p.Dnb=function(a){a.stopPropagation();this.F&&this.Aa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.fBa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Ha=function(){s2.oa.Ha.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function gOd(a){var b=a.description;a=a.DRb;return P('<div class="waffle-dv-rec-chip" title="'+Q(b)+'"><div class="waffle-dv-rec-range">'+O(a)+'</div><div class="waffle-dv-rec-description">'+O(b)+"</div></div>")}function hOd(){return P('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function t2(){var a=new $L(null);Rq(a,!0);return a};function iOd(a,b,c){E.call(this);this.D=a;this.Pf=b;this.fc=c;this.R=this.H=this.Ga=this.Ea=this.ma=this.F=null;this.wc=new yO;this.Ba(this.wc);this.ue=new yO;this.Ba(this.ue);this.Aa=this.O=null;this.Dd=new yO;this.Ba(this.Dd);this.Oe=new yO;this.Ba(this.Oe);this.eb=this.Oa=this.Na=this.qa=this.L=null;this.Ld=new yO;this.Ba(this.Ld);this.$d=new yO;this.Ba(this.$d);this.dd=new yO;this.Ba(this.dd);this.Fe=new yO;this.Ba(this.Fe);this.pb=this.Uc=null;this.C=new OT("");this.Ba(this.C);this.sb=this.J=
this.Jb=this.Hb=this.Ve=this.Hc=this.Qb=this.Eb=null;this.xg=this.qd=!1;this.Pb=this.Hf=this.jb=this.xb=null;this.rf=new Yh(this);this.Ba(this.rf);this.Yc=new Zu;this.gg=this.Ng=this.yg=this.Zf=this.Mg=this.La=null;this.Ys();a=this.rf;a.V(this.F,"action",this.ltb);a.V(this.ma,"action",this.vma);a.V(this.Ea,"action",this.vma);a.V(this.Ga,"action",this.vma);a.V(this.J,"focus",Ba(this.rRa,!0));a.V(this.J,"blur",Ba(this.rRa,!1));a.V(this.J,"change",this.ima);a.V(this.J,"keyup",this.ima);b=[this.O,this.Aa,
this.H,this.R,this.L,this.qa,this.Oa,this.eb];for(c=0;c<b.length;c++)this.rf.V(b[c],"change",v(this.JZb,this,b[c])),this.rf.V(b[c],"keyup",v(this.gtb,this,b[c]));a.V(this.jb,"change",v(this.bJa,this));a.V(this.Na,"change",v(this.fFb,this));a.Cg(this.sb,pf,this.oAb)}x(iOd,E);var jOd="placeholder"in document.createElement("input"),kOd=/\s*,\s*/;
function lOd(a){var b=a.gg;b||(b=[{aj:"List from a range",type:4},{aj:"List of items",type:3},{aj:"Number",type:0},{aj:"Text",type:1},{aj:"Date",type:2},{aj:"Custom formula is",type:5},{aj:"Checkbox",type:6}],a.gg=b);return b}
function mOd(a){var b=a.Ng;b||(b=[{aj:"contains",code:9,inputs:0,example:"Approved"},{aj:"does not contain",code:10,inputs:0,example:"Approved"},{aj:"equals",code:13,inputs:0,example:"Approved"},{aj:"is valid email",code:14,inputs:-1,example:null},{aj:"is valid url",code:15,inputs:-1,example:null}],a.Ng=b);return b}
function nOd(a){var b=a.Zf;b||(b=[{aj:"is valid date",code:30,inputs:-1,example:null},{aj:"equal to",code:16,inputs:2,example:"11/15/2014"},{aj:"before",code:17,inputs:2,example:"11/15/2014"},{aj:"on or before",code:19,inputs:2,example:"11/15/2014"},{aj:"after",code:18,inputs:2,example:"11/15/2014"},{aj:"on or after",code:20,inputs:2,example:"11/15/2014"},{aj:"between",code:21,inputs:3,example:"11/15/2014",UP:"11/15/2015"},{aj:"not between",code:22,inputs:3,example:"11/15/2014",UP:"11/15/2015"}],
a.Zf=b);return b}function oOd(a){var b=a.yg;b||(b=[{aj:"range",code:23,inputs:6,example:null},{aj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.yg=b);return b}
function pOd(a){var b=a.Mg;b||(b=[{aj:"between",code:7,inputs:8,example:"10",UP:"100"},{aj:"not between",code:8,inputs:8,example:"10",UP:"100"},{aj:"less than",code:3,inputs:7,example:"10"},{aj:"less than or equal to",code:4,inputs:7,example:"10"},{aj:"greater than",code:1,inputs:7,example:"10"},{aj:"greater than or equal to",code:2,inputs:7,example:"10"},{aj:"equal to",code:5,inputs:7,example:"10"},{aj:"not equal to",code:6,inputs:7,example:"10"}],a.Mg=b);return b}
function qOd(){return{aj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function rOd(){return{aj:"",code:31,inputs:-1,example:""}}p=iOd.prototype;
p.Ys=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,K=a.va(),R;var W=K.Da("TR","waffle-dv-trrules",K.Da("TD","waffle-dv-label",K.Da("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),K.Da("TD",{colspan:"7"},l=K.Da("DIV","goog-inline-block"),R=K.Da("DIV","goog-inline-block"),h=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=K.Da("SPAN","waffle-dv-separator","and"),k=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.dd.qb(h);this.Fe.qb(k);this.Dd.qb(c);this.Oe.qb(d);this.wc.qb(e);this.ue.qb(f);var U=t2();Ni(U,l);var la=t2();Ni(la,l);var ra=t2();Ni(ra,l);var Ca=t2();Ni(Ca,l);var Ha=sOd(a,R);(w=U.getElement())&&Lh(w,"labelledby","waffle-dv-criteria");
var Ka;var Ma=K.Da("TR","waffle-dv-trrules waffle-dv-trrules-showitems",K.Da("TD"),K.Da("TD",{colspan:"7"},Ka=K.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new Ys;Ws(w,Ka);Ni(w,Ka);var Qa=K.Da("TR","waffle-dv-trrules waffle-dv-trrules-showitems",K.Da("TD"),K.Da("TD",{colspan:"7"},m=K.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Ab=new Ys;Ws(Ab,m);Ni(Ab,m);var qb=K.Da("TR","waffle-dv-trrules",K.Da("TD"),K.Da("TD","waffle-dv-customcheckboxlabel",
K.Da("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),K.Da("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var db=K.Da("TR","waffle-dv-trrules",K.Da("TD"),K.Da("TD","waffle-dv-customcheckboxlabel",K.Da("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),K.Da("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=K.Da("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Ld.qb(r);
this.$d.qb(u);Lh(r,"labelledby","customCheckboxInputLabel_checked");Lh(u,"labelledby","customCheckboxInputLabel_unchecked");vP(this.Ld,"e.g., TRUE");vP(this.$d,"e.g., FALSE");var Pc=K.Da("TR","waffle-dv-trrules",K.Da("TD","waffle-dv-label",K.Da("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),K.Da("TD",{colspan:"7"},K.Da("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},K.Da("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),K.Da("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),K.Da("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),K.Da("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new nNc(!0);oNc(m,"onInvalidData",Pc);var fc=K.Da("TR","waffle-dv-trrules waffle-dv-trrules-appearance",K.Da("TD",null,K.Da("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),K.Da("TD",{colspan:"7"},y=K.Da("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Zc=new Ys;Ws(Zc,y);Ni(Zc,y);y=Zc.Pa();var cd=kja(y,"labelledby");Lh(y,"labelledby","waffle-dv-appearance "+cd);y=K.Da("TR","waffle-dv-trrules",K.Da("TD"),K.Da("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=K.Da("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),cd=K.Da("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));Ae(cd,!0);a=a.Ea.childNodes[0];K.appendChild(a,W);K.appendChild(a,
Ma);K.appendChild(a,Qa);K.appendChild(a,qb);K.appendChild(a,db);K.appendChild(a,Pc);K.appendChild(a,fc);K.appendChild(a,y);this.C.render(l);K=this.C;K.Roa=29;K.resize();K=this.C;K.uMa=200;K.resize();this.C.getElement().style.width="324px";jOd?this.C.getElement().placeholder="Enter items separated by a comma...":(K=this.C.getElement(),wj(K,"Enter items separated by a comma...","Enter items separated by a comma..."));if(K=this.C.getElement())Ph(K,"Enter items separated by a comma..."),Sh(K,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;U.setVisible(!0);K=lOd(this);tOd(this,K,U);K=pOd(this);tOd(this,K,Ca);K=mOd(this);tOd(this,K,la);K=nOd(this);tOd(this,K,ra);uOd(this,U,Ca,la,ra,h,k,c,d,e,f,b,l,Ha,Ma,y,w,Ka,cd,Zc,R,m,Ab,r,u,Qa,qb,db)};
function uOd(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,K,R,W,U,la,ra,Ca,Ha,Ka,Ma,Qa,Ab,qb){a.F=b;a.F.setVisible(!0);a.Ea=c;a.ma=e;a.Ga=d;a.Uc=u;a.L=f;a.qa=h;a.O=k;a.Aa=l;a.H=m;a.R=r;a.pb=w;a.La=y;a.Eb=ra;a.Na=Ha;a.Oa=Ka;a.eb=Ma;a.Ve=Qa;a.Hb=Ab;a.Jb=qb;L(a.Ve,!1);L(a.Hb,!1);L(a.Jb,!1);la.Dc(!1);a.jb=la;a.Pb=Ca;vOd(a,!1);a.Qb=B;R.Dc(!0);a.xb=R;a.Hf=W;a.Hc=K;L(a.Hc,!0);wOd(a);xOd(a);a.sb=U;L(a.sb,!1)}
function yOd(a,b){L(a.Qb,23==b||24==b);a.Hf.innerText="Show dropdown list in cell";b=31==b;L(a.Ve,b);var c=a.Na.isChecked();L(a.Hb,b&&c);L(a.Jb,b&&c)}function zOd(a){uOd(a,a.F,a.Ea,a.Ga,a.ma,a.L,a.qa,a.O,a.Aa,a.H,a.R,a.Uc,a.pb,a.La,a.Qb,a.Hc,a.xb,a.Hf,a.sb,a.jb,a.Eb,a.Pb,a.Na,a.Oa,a.eb,a.Ve,a.Hb,a.Jb)}function tOd(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.va();e=new Sk(b[d].aj,null,e);c.yd(e);Kh(e.getElement(),"menuitem")}c.$e(0)}p.vma=function(){xOd(this);this.J.value=AOd(this);this.dispatchEvent("change")};
p.ltb=function(){wOd(this);xOd(this);this.J.value=AOd(this);this.dispatchEvent("change")};p.rRa=ca("xg");p.ima=function(a){this.qd||a&&!Pla(a)||this.J.value===BOd(this)||(this.qd=!0,L(this.sb,!0))};p.oAb=function(){this.qd=!1;this.J.value=AOd(this);L(this.sb,!1)};p.bJa=function(){L(this.Hc,this.jb.isChecked())};p.fFb=function(){var a=this.Na.isChecked();a||COd(this);L(this.Hb,a);L(this.Jb,a);DOd(this)};function DOd(a){a.J.value=AOd(a)}function EOd(a){DOd(a);a.C.resize()}
p.JZb=function(a){DOd(this);FOd(this,a)?(this.D.wl=0,u2(a),this.dispatchEvent("change")):(this.D.wl=1,v2(a),this.dispatchEvent("error"))};p.gtb=function(){this.dispatchEvent("keyup")};function FOd(a,b){if(0!=w2(a))return!0;var c=b.value;if(null!=c&&Di(b)){if(!x2(a.D))return!0;a=y2(a,c,GOd(a).code);return null!=a&&(Ru(a,3)||Ru(a,5)&&a.Mo().Cd()&&3==V(a.Mo().getValue(),1))}return!0}function v2(a){a.select();J(a,"waffle-input-error")}function u2(a){a&&Th(a,"waffle-input-error")}
function COd(a){u2(a.C.getElement());u2(a.H);u2(a.R);u2(a.L);u2(a.qa);u2(a.Oa);u2(a.O);u2(a.Aa);u2(a.La.Ir());a.D.wl=0;a.dispatchEvent("change")}function w2(a){return lOd(a)[a.F.Yg()].type}function wOd(a){var b=w2(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.ma.setVisible(c);a.Ea.setVisible(d);a.Ga.setVisible(e);L(a.pb,f);L(a.Eb,h);L(a.L,!1);L(a.qa,!1);L(a.O,!1);L(a.Aa,!1);L(a.H,!1);L(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function GOd(a){var b;null!=HOd(a)?b=HOd(a):a.ma.isVisible()?b=nOd(a)[a.ma.Yg()]:a.Ea.isVisible()?b=pOd(a)[a.Ea.Yg()]:5==w2(a)?b=qOd():6==w2(a)?b=rOd():b=mOd(a)[a.Ga.Yg()];return b}function HOd(a){var b=oOd(a);return 4==w2(a)?b[0]:3==w2(a)?b[1]:null}
function xOd(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=GOd(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=GOd(a);if(3==w2(a))jOd?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),wj(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)vP(a.Dd,"e.g., "+
u.example),vP(a.Oe,"e.g., "+u.UP||"");else if(2==u.inputs||3==u.inputs)vP(a.wc,"e.g., "+u.example),vP(a.ue,"e.g., "+u.UP||"");else if(7==u.inputs||8==u.inputs)vP(a.dd,"e.g., "+u.example),vP(a.Fe,"e.g., "+u.UP||"");COd(a);L(a.L,b);L(a.qa,c);L(a.O,d);L(a.Aa,e);L(a.H,f);L(a.R,h);L(a.pb,l);l&&a.C.resize();L(a.Eb,m);yOd(a,r.code);L(a.Uc,k)}
function y2(a,b,c){var d=x2(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.yc();e=e.Ac();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.Yc.zd(xv.Ca(),b):null}
function IOd(a){var b=new Cv,c=GOd(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(y2(a,a.O.value,d));break;case 1:e.push(y2(a,a.O.value,d));e.push(y2(a,a.Aa.value,d));break;case 2:e.push(y2(a,a.H.value,d));break;case 3:e.push(y2(a,a.H.value,d));e.push(y2(a,a.R.value,d));break;case 7:e.push(y2(a,a.L.value,d));break;case 8:e.push(y2(a,a.L.value,d));e.push(y2(a,a.qa.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(DEc(a[c]));break;case 6:c=Pob("="+a.La.getValue());e.push(y2(a,
c,d));break;case -1:a.Na.isChecked()&&(e.push(y2(a,Mb(a.Oa.value),d)),Jb(a.eb.value)||e.push(y2(a,Mb(a.eb.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=nS(d,e);X(b,1,d);return b}function JOd(a){var b=Mb(a.La.getValue());!a.fc.D.D[Mb(Yb(b).toLowerCase())]&&JR(a.fc,b)&&(b=ECc(a.fc,b,!0));return b}function AOd(a){return a.qd||a.xg?a.J.value:BOd(a)}
function BOd(a){var b="";var c=w2(a);var d=4==c;c=3==c||4==c;if(a.ma.isVisible())c=nOd(a)[a.ma.Yg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ga.isVisible())c=mOd(a)[a.Ga.Yg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=HOd(a),b+="Click and enter a value from ";else if(5==w2(a))c=qOd(),b="Enter a value that satisfies the formula:";else if(6==w2(a))if(c=rOd(),a.Na.isChecked()&&!Jb(Mb(a.Oa.value))){b=Mb(a.Oa.value);
var e=Mb(a.eb.value);b=Jb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=pOd(a)[a.Ea.Yg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.aj);e=JOd(a);23==c.code&&""!=e&&d&&(d=ECc(a.fc,e,!0))&&(b+=" "+d);Jb(Yb(a.O.value))||0!=c.inputs&&1!=c.inputs?Jb(Yb(a.H.value))||2!=c.inputs&&3!=c.inputs?Jb(Yb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Jb(Yb(a.Aa.value))||1!=c.inputs?Jb(Yb(a.R.value))||3!=c.inputs?Jb(Yb(a.qa.value))||
8!=c.inputs||(b+=" and "+a.qa.value):b+=" and "+a.R.value:b+=" and "+a.Aa.value;return b}function vOd(a,b){pNc(a.Pb,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function z2(a,b){switch(b){case 0:a.F.$e(2);break;case 1:a.F.$e(3);break;case 2:a.F.$e(4);break;case 3:a.F.$e(1);break;case 4:a.F.$e(0);break;case 5:a.F.$e(5);break;case 6:a.F.$e(6)}}
function KOd(a,b,c,d,e){a.F.$e(0);a.ma.$e(0);a.Ea.$e(0);a.Ga.$e(0);a.J.value="";a.L.value="";a.qa.value="";a.H.value="";a.R.value="";a.O.value="";a.Aa.value="";a.C.fb("");a.La.fb("");vOd(a,!1);var f=a.qd=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,K=!1,R=!1,W=!1,U=!1,la=!1,ra=!1,Ca=!1,Ha=!1,Ka=b&&Dv(b);b=Ka&&zv(Ka);if((Ka=Ka&&Av(Ka))&&b){for(var Ma=oOd(a),Qa=nOd(a),Ab=pOd(a),qb=mOd(a),db=qOd(),Pc=rOd(),fc=0,Zc=0;Zc<Ma.length;Zc++)if(b==Ma[Zc].code){fc=Ma[Zc].inputs;23==Ma[Zc].code?(ra=!0,z2(a,
4)):(R=!0,z2(a,3));a.xb.Dc(!!e);break}for(e=0;e<Qa.length;e++)if(b==Qa[e].code){fc=Qa[e].inputs;a.ma.$e(e);z2(a,2);W=w=!0;break}for(e=0;e<Ab.length;e++)if(b==Ab[e].code){fc=Ab[e].inputs;a.Ea.$e(e);z2(a,0);U=y=!0;break}for(e=0;e<qb.length;e++)if(b==qb[e].code){fc=qb[e].inputs;a.Ga.$e(e);z2(a,1);la=B=!0;break}b==db.code&&(fc=db.inputs,z2(a,5),Ca=!0);b==Pc.code&&(fc=Pc.inputs,z2(a,6),Ha=!0);if(W||la||U||R||ra||Ca||Ha)if(la=x2(a.D),W=la.rect.yc(),U=la.rect.Ac(),la=la.C,-1==fc)Ha&&0<Ka.length&&(K=!0,a.Na.Dc(!0),
a.Ld.fb(HE(Ka[0],la,W,U)),1<Ka.length&&a.$d.fb(HE(Ka[1],la,W,U)));else if(0==fc)m=HE(Ka[0],la,W,U),a.Dd.fb(m),m=!0;else if(1==fc)r=HE(Ka[0],la,W,U),m=HE(Ka[1],la,W,U),a.Dd.fb(r),a.Oe.fb(m),r=m=u=!0;else if(2==fc)f=HE(Ka[0],la,W,U),a.wc.fb(f),f=!0;else if(3==fc)h=HE(Ka[0],la,W,U),f=HE(Ka[1],la,W,U),a.wc.fb(h),a.ue.fb(f),h=f=u=!0;else if(7==fc)k=HE(Ka[0],la,W,U),a.dd.fb(k),k=!0;else if(8==fc)l=HE(Ka[0],la,W,U),k=HE(Ka[1],la,W,U),a.dd.fb(l),a.Fe.fb(k),l=k=u=!0;else if(5==fc){R=!0;Ha=[];for(fc=0;fc<Ka.length;fc++)Ha.push(HE(Ka[fc],
la,W,U));a.C.fb(Ha.join(","));a.C.resize()}else 6==fc&&(ra=!0,Ha=HE(Ka[0],la,W,U),null!=Ha&&(Ha=Ha.substring(1),Ka=!!YF(Ha),Ha=(fc=$F(Ha,a.Pf,!1,!0))?bG(fc.rect,QF(a.Pf,fc.C).pe()):Ha,Ka||(Ha=ZF(Ha)),a.La.fb(Ha)));else a.F.$e(0),ra=!0;L(a.Uc,u);a.ma.setVisible(w);a.Ea.setVisible(y);a.Ga.setVisible(B);L(a.H,f);L(a.R,h);L(a.O,m);L(a.Aa,r);L(a.L,k);L(a.qa,l);L(a.Hb,K);L(a.Jb,K);L(a.Qb,!0);L(a.pb,R);a.C.resize();L(a.Eb,ra);null!=b&&yOd(a,b)}else{if(Eh(H(),"feadv")){w=CG(a.Pf);y=w.Sc();B=new pr;for(K=
y.yc();K<y.ad();K++)for(R=y.Ac();R<y.hd();R++)ra=w.gh(K,R),""!=SE(ra)&&qr(B,SE(ra).split(kOd));B.isEmpty()?w=!1:(zOd(a),a.C.fb(B.Ad().join(",")),z2(a,3),wOd(a),w=!0)}else w=!1;w||zOd(a)}a.bJa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Rb(Mb(c.substring(w+9))));a.jb.Dc(!!c);c&&(AOd(a)!=c&&a.ima(),a.J.value=c,L(a.Hc,!0));vOd(a,d)}
p.Ha=function(){this.Qb=this.xb=this.sb=this.J=this.Uc=this.eb=this.Oa=this.qa=this.L=this.Aa=this.O=this.R=this.H=null;C(this.La);this.La=null;C(this.xb);this.xb=null;C(this.Ga);this.Ga=null;C(this.Ea);this.Ea=null;C(this.ma);this.ma=null;C(this.F);this.F=null;C(this.jb);this.jb=null;C(this.Pb);this.Pb=null;iOd.oa.Ha.call(this)};function LOd(a,b,c,d,e,f,h){Ip.call(this);this.Jb=a;this.Oe=b;this.xb=c;this.ue=d;this.O=e;this.jb=f;this.Hb=h;this.R=new M(this.va());this.Ia(this.R);this.Uc=new rq("",new RT,this.va());this.Ia(this.Uc);this.pb=new M(this.va());this.Ia(this.pb);this.Na=new lS(!1,"#4285f4");this.Ia(this.Na);this.qd=new ST(c,MOd.Bda,MOd.Cda);this.Ba(this.qd);this.F=this.Ea=null;this.dd=new Yh(this);this.Ba(this.dd);this.Eb=this.Aa=this.J=this.C=null;this.eb=Eh(H(),"fedvs");this.sb=this.L=null;this.Pb=-1;this.wc=[];
this.fc=[];this.Dd=-1;a=ED(this.xb).Sc();this.Fe=tw(a.yc(),a.Ac(),a.ad(),a.hd());this.Qb=!1;this.Hc=new Yh(this);this.Ba(this.Hc);this.Aa=new Up;this.Aa.set("save","Save",!1);this.Aa.set("clear","Remove validation",!1,!1);this.Aa.set("cancel","Cancel",!1,!0);Xp(this,this.Aa);Tp(this,!1);this.render();a=this.Sb();b=this.va();c=MOd;Jp(this,"Data validation");this.J||(d=b.Da("DIV",{"class":c.QVa}),e=b.Da("DIV",{"class":c.PVa},d),b.appendChild(a,e),this.J=new wo(e),this.J.setType("warning"),this.J.setContent(""),
this.J.render(d),Wwa(this.J,!0),this.J.setVisible(!1));this.eb&&(e=b.Da("DIV",c.x1a),f=b.Da("DIV",{id:NOd.uwa},"Suggested validations"),d=b.Da("DIV",c.w1a),h=b.Da("DIV",c.Lua,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Uc.qb(h),L(h,wz),this.R.qb(d),e=b.Da("DIV",c.b1a),b.appendChild(d,e),this.pb.qb(e),this.Na.render(e),mS(this.Na,!0));this.Ea=b.Da("TABLE",{cellSpacing:"0","class":c.eB},b.Da("TBODY"));b.appendChild(a,this.Ea);this.eb&&J(this.Ea,
c.F1a);a=this.Sb();a=Sd(a);b=a.Da("TR",MOd.X1a);b.appendChild(a.Da("TD","waffle-dv-label",a.Da("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Da("TD",{colspan:"7"});this.C=sOd(this,c);OOd(this);b.appendChild(c);a.appendChild(this.Ea.childNodes[0],b);(a=this.C.Ir())&&Lh(a,"labelledby","waffle-dv-cell-range");this.F=new iOd(this,this.Jb,this.O);hq(this,"save");POd(this)}x(LOd,Ip);
var MOd={PVa:"waffle-input-error-butter-container",QVa:"waffle-input-error-butter-wrap",Lua:"waffle-dv-feedback-link",Bda:"waffle-dv-highlight-styled-border",Cda:"waffle-dv-highlight-styled-rect",dva:"waffle-input-error",b1a:"waffle-dv-rec-spinner-container",wea:"waffle-dv-rec-chip-selected",w1a:"waffle-dv-rec-wrapper",x1a:"waffle-dv-recs-title-bar",eB:"waffle-dv-table",F1a:"waffle-dv-table-with-suggestions",X1a:"waffle-dv-trrules"},NOd={uwa:"waffle-dv-recs-title"};p=LOd.prototype;p.wl=0;
function OOd(a){if(a.C){var b=a.Jb.getActiveGrid();b&&(b=bG(ED(a.xb).Sc(),b.pe(),!0),a.C.fb(b))}}function POd(a){a.dd.V(a,"dialogselect",a.IZb).V(a.F,"error",a.etb).V(a.F,"change",a.HZb).V(a.C,"change",function(){a.F&&DOd(a.F);if(a.eb){var b=x2(a);a.Qb||a.L&&b&&b.intersects(KR(a.O,a.sb))||QOd(a)}});a.eb&&a.dd.V(a.jb,"recommender-calc-ended",a.GZb).V(a.Uc,"action",function(){I.Pu.gc({source:"dataValidationDialogFeedback"})})}p.etb=function(){ROd(this)};
p.HZb=function(){ROd(this);$p(this.Aa,"save",!0)};function SOd(a){var b=a.va();a=a.R.Pa();var c=N(hOd);b.appendChild(a,c)}
p.GZb=function(a){var b=this;mS(this.Na,!1);L(this.pb.Pa(),!1);a=a.C;if(0==a.length)SOd(this);else for(var c=this.va(),d=this.R.Pa(),e=0,f={Xe:0};f.Xe<a.length;f={zN:f.zN,QD:f.QD,z0:f.z0,Xe:f.Xe,nf:f.nf,HD:f.HD},f.Xe++){var h=a[f.Xe],k=V(h,13);if(3<=e||!k)break;e++;f.nf=FR(h);f.z0=bG(Uw(f.nf));f.QD=V(k,3);this.wc.push(f.QD);this.fc.push(f.z0);h="";switch(zv(f.QD)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+Av(f.QD).map(function(a){return V(a.Mo().getValue(),
2)}).join();break;case 1:h="Greater than "+V(Av(f.QD)[0].Mo().getValue(),3);break;case 7:h=Av(f.QD);h="Between "+(V(h[0].Mo().getValue(),3)+(" and "+V(h[1].Mo().getValue(),3)));break;case 5:h=Av(f.QD);h="Equal to "+V(h[0].Mo().getValue(),3);break;default:vnc.C("Unrecognized data validation type.")}k=NOd;f.HD=N(gOd,{description:h,DRb:f.z0});f.zN=new Gq("",c);f.zN.kf(8,!0);f.zN.qb(f.HD);Lh(f.HD,"describedby",k.uwa);this.R.Ia(f.zN);c.appendChild(d,f.HD);this.Hc.V(f.zN,"action",function(a){return function(){TOd(b,
a.zN,a.QD,a.z0,a.Xe)}}(f)).V(f.HD,"mouseenter",function(a){return function(){TT(b.qd,Tw(a.nf))}}(f)).V(f.HD,"mouseleave",function(){UT(b.qd)}).V(f.HD,"focus",function(a){return function(){ui(a.HD,d)}}(f))}};function TOd(a,b,c,d,e){var f=MOd,h=Rh(b.Pa(),f.wea);a.R.qf(function(a){a.lk(f.wea,!1);a.rc(!1)});b.lk(f.wea,!h);b.rc(!h);a.Qb=!0;h?(a.show(!0),a.L=null,a.sb=null,a.Pb=-1):(b=new Cv,X(b,1,c),KOd(a.F,b,null,null,!0),EOd(a.F),a.C.fb(d),a.L=c,a.sb=d,a.Pb=e);a.Qb=!1}
p.IZb=function(a){if("save"==a.key){if(!UOd(this)){a.preventDefault();return}}else if("clear"==a.key&&!VOd(this)){a.preventDefault();return}this.C&&this.C.$a(!1)};function ROd(a){var b=WOd(a.wl);b&&a.J.setContent(b);a.J.setVisible(0!=a.wl);b=2==a.wl||4==a.wl;var c=MOd,d=a.va().Vw(a.C.getElement());Vh(d,c.dva,b);b&&a.C.Ir().select()}
function WOd(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function XOd(a){var b=a.F,c=w2(b);if(0==c){c=b.L;var d=b.qa,e=FOd(b,c),f=FOd(b,d);e&&f?b.D.wl=0:(e||v2(c),f||v2(d),b.D.wl=1)}else if(1==c)c=b.O,d=b.Aa,e=!Di(c)||!Jb(Yb(c.value)),f=!Di(d)||!Jb(Yb(d.value)),e&&f?b.D.wl=0:(e||v2(c),f||v2(d),b.D.wl=6);else if(2==c)c=b.H,d=b.R,e=!Di(c)||!Jb(Yb(c.value)),f=!Di(d)||!Jb(Yb(d.value)),e&&f?b.D.wl=0:(e||v2(c),f||v2(d),b.D.wl=7);else if(3==c||4==c)c=0,4==w2(b)?(d=JOd(b),JR(b.fc,d)?(d=JOd(b),d=KR(b.fc,d),e=x2(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==w2(b)&&b.C.getElement()&&Jb(Yb(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.wl=d,d=b.Eb&&Di(b.Eb),b.pb&&Di(b.pb)?(Vh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.va().Vw(b.La.getElement()),Vh(d,"waffle-input-error",!c),b.La.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Na.isChecked()){c=b.Oa;e=b.eb;d=Mb(Yb(c.value));e=Mb(Yb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==
e.toLowerCase();var h=ec(d)==ec(e);f=d==e||h||f;Jb(d)?(v2(c),b.D.wl=8):f?b.D.wl=9:nC(d)||nC(e)?b.D.wl=10:b.D.wl=0}}else b.D.wl=0;b=a.C.getValue();b=JR(a.O,b);2==a.wl&&b?a.wl=0:0!=a.wl||b||(a.wl=2);ROd(a);return 0!=a.wl}
function UOd(a){if(XOd(a))return!1;var b=a.F,c=b.Pb.isChecked("rejectInvalidData_radio"),d=AOd(b);b.jb.isChecked()||(d="");var e=IOd(b);if(!e)return!1;var f=new rx;X(f,1,e);X(f,2,d);X(f,3,c);lCc(f,Di(b.Qb)&&b.xb.isChecked());b=YOd(a);if(!b)return!1;c=new Kg;e=Dv(e);d=a.L&&zv(a.L)==zv(e);var h=Av(e);if(d){var k=ZOd(a,TNd(a.O,a.sb)),l=$Od(a);k=Vw(k,b);G(c,12,!l||!k);var m=new XNd;G(m,1,!k);G(m,2,!l);G(m,3,a.Pb);hP(c,17,$fa[0],m)}else{for(var r=m=k=l=!1,u=!1,w=0;w<a.fc.length;w++){var y=ZOd(a,TNd(a.O,
a.fc[w]));if(y){var B=Vw(y,b);y=W_a(y,b);var K=a.wc[w],R=zv(K)==zv(e);K=Av(K);K=wb(K,h,function(a,b){return a.equals(b)});u=u||K;l=l||B&&R&&K;k=k||B;m=m||B&&R;r=r||y}}w=new YNd;G(w,1,l);G(w,2,k);G(w,3,m);G(w,4,r);G(w,5,u);hP(c,18,$fa[0],w)}cCc(c,NLc(zv(e)));l=ha(a.wc);for(k=l.next();!k.done;k=l.next())RNd(c,NLc(zv(k.value)));l=Ea()-a.Dd;G(c,14,l);l=new Ig;dg(l,58,c);c=Uj(Vj(new Tj,l),1).build();a.Hb.Mb(d?35578:35301,c);31==zv(e)&&a.Hb.Mb(0<h.length?35604:35603,c);a.ue.C(new pMc(f,b));return!0}
function $Od(a){var b=IOd(a.F);if(!b||!a.L)return!1;b=Av(Dv(b));a=Av(a.L);return wb(a,b,function(a,b){return a.Mo().getValue().equals(b.Mo().getValue())})}
function VOd(a){var b=YOd(a);if(!b)return!1;try{if(!IOd(a.F))return a.Hb.Mb(35300),!0;var c=Dv(IOd(a.F)),d=a.L&&zv(a.L)==zv(c),e=!1,f=new Kg;if(d){var h=mnb(ED(a.xb).Bp().Lc(),TNd(a.O,a.C.getValue()));nk(h,function(a){UE(a)&&(e=!0);return e});if(!e){var k=new YNd;G(k,6,!0);hP(f,18,$fa[0],k)}}var l=new Ig;dg(l,58,f);var m=Uj(Vj(new Tj,l),1).build();a.Hb.Mb(35300,m);return!0}finally{a.ue.C(new pMc(new rx,b))}}function YOd(a){var b=TNd(a.O,a.C.getValue());return ZOd(a,b)}
function ZOd(a,b){var c=a.C.getValue();a=(a=KR(a.O,c))?a.C:null;return b&&null!=a?Qw(b,a):null}function x2(a){var b=a.C.getValue();return KR(a.O,b)}function sOd(a,b){var c=a.Jb.C.pe();a=new MO(a.xb,v(a.FZb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.va());a.render(b);return a}p.setVisible=function(a){LOd.oa.setVisible.call(this,a);a&&this.Eb&&(this.Eb.focus(),this.Eb=null)};p.FZb=function(a,b,c,d){this.Eb=a.Ir();gqb(this.Oe,this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=CG(this.Jb),e=UE(uF(d,AF(d)));d=null;var f=!1;e&&(e=e.C,d=V(e,1),b=V(e,2),c=V(e,3),f=V(e,4));KOd(this.F,d,b,c,f);(b=IOd(this.F))&&Dv(b);this.setVisible(!0);this.C&&this.C.$a(!0);OOd(this);EOd(this.F);QOd(this,a);this.Dd=Ea()};
function QOd(a,b){a.eb&&!b&&(vCc(a.jb)?(mS(a.Na,!0),L(a.pb.Pa(),!0),a.R.Ed(!0),a.Hc.Qc(),qCc(a.jb),b=x2(a),null==b||Aw(b.rect)||b.rect.equals(a.Fe)?pDc(a.jb,!0,!1,[6]):oDc(a.jb,!0,!1,!1,[6],[x2(a).rect])):(mS(a.Na,!1),L(a.pb.Pa(),!1),SOd(a)))}p.Ha=function(){C(this.F);this.F=null;C(this.C);this.Aa=this.Ea=this.C=null;C(this.J);LOd.oa.Ha.call(this)};function aPd(a,b,c,d,e){Ip.call(this);this.jb=c;this.sb=d.C;this.eb=d;this.fc=e;this.pb=null;this.Jb=d.Aa;Jp(this,"Find and replace");Tp(this,!1);c=this.Sb();d=Sd(c);this.C=d.Da("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Na=d.Da("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new $L(null);this.Ba(this.F);this.Hc=b;this.O=new MO(this.jb,v(this.LZb,this),!1,"",!0);this.Ba(this.O);this.Aa=null;this.R=new Ys;this.Ba(this.R);this.Ea=new Ys;this.Ba(this.Ea);
this.L=new Ys;this.Ba(this.L);this.J=new Ys;this.Ba(this.J);this.Qb=this.Eb=this.Hb=this.Pb=!1;this.xb=d.Da("SPAN");zEc(this.xb);this.wc=new zr(this.C);this.Ba(this.wc);a=bPd;d.Da("LABEL",{"for":a.Oua},"Search");b=d.Da("LABEL",{"for":a.Ava},"Match case");e=d.Da("LABEL",{"for":a.Bva},"Match entire cell contents");var f=d.Da("LABEL",{},"Also search within formulas"),h=d.Da("LABEL",{"for":a.ewa},"Search using regular expressions "),k=(new Hl(P5a)).toString(),l=d.Da("SPAN",null,d.Da("A",{target:"_blank",
href:k},"Help"));this.getHandler().V(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});k=Oi(this,"findLabel");var m=Oi(this,"replaceLabel"),r=Oi(this,"findScopeLabel"),u=d.Da("DIV","goog-inline-block"),w=d.Da("DIV",a.y0a);l=d.Da("TABLE",null,d.Da("TBODY",null,d.Da("TR",null,d.Da("TD",a.LABEL,d.Da("LABEL",{id:k},"Find")),d.Da("TD",null,this.C)),d.Da("TR",null,d.Da("TD",a.LABEL,d.Da("LABEL",{id:m},"Replace with")),d.Da("TD",null,this.Na)),d.Da("TR",null,d.Da("TD",null,d.Da("LABEL",
{id:r},"Search")),d.Da("TD",null,u,w)),d.Da("TR",null,d.Da("TD",null,""),d.Da("TD",null,b,d.Da("BR"),e,d.Da("BR"),h,l,d.Da("BR"),f)),d.Da("TR",null,d.Da("TD",{colspan:"2"},this.xb))));this.F.render(u);J(this.F.getElement(),a.Oua);this.O.render(w);Ni(this.R,b);Ws(this.R,b);this.R.getElement().id=a.Ava;Ni(this.Ea,e);Ws(this.Ea,e);this.Ea.getElement().id=a.Bva;Ni(this.L,h);Ws(this.L,h);this.L.getElement().id=a.ewa;Ws(this.J,f);Ni(this.J,f);Lh(this.C,"labelledby",k);Lh(this.Na,"labelledby",m);Lh(this.F.Pa(),
"labelledby",r);d.appendChild(c,l);c=new Up;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Xp(this,c);hq(this,"");this.getHandler().V(this,"dialogselect",this.MZb).V(this.wc,"input",this.tna).V(this.L,"change",this.eBb).V(this.F,"change",this.hrb).V(this.O,"change",this.NZb).V(this.J,"change",this.hBb);c=new Ar;c.qb(this.C);this.Ba(c);c=new Ar;c.qb(this.Na);this.Ba(c);cPd(this);c=new Gp(this.getElement());this.Ba(c);this.getHandler().V(c,
"focusin",this.tUa).V(this.getElement(),"mousedown",this.tUa)}x(aPd,Ip);var bPd={cua:"waffle-find-replace-dialog-border",Oua:"waffle-find-replace-find-scope-select",dva:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",Ava:"find-replace-case",Bva:"find-replace-cell",ewa:"find-replace-regex",y0a:"waffle-find-replace-selection-input goog-inline-block"};
function cPd(a){var b=ED(a.jb),c=null,d=null;b&&(c=EUb(b),d=QF(a.sb,c.C).pe());a.J.Dc(a.Jb);var e=new Sk("All sheets",Sdb.tVa),f=new Sk("This sheet",Sdb.H0a),h=new Sk("Specific range",Sdb.qE);a.F.yd(e);a.F.yd(f);a.F.yd(h);f=c?HG(a.sb,c.C):null;f=(f=c&&f?jF(f,c.rect.yc(),c.rect.Ac()):null)?f.Xg():1;c&&c.rect.Xg()>f?er(a.F,h):er(a.F,e);b&&a.O.fb(bG(c.rect,d))}function dPd(a){var b=a.F.Ze().kb(),c=SF(a.jb.C);return 0==b?$F(a.O.getValue(),a.sb,!1,!0):1!=b||null===c?null:new Mw(c,new sw(0,0,1,1))}p=aPd.prototype;
p.tUa=function(a){a.target==this.getElement()?this.focus():this.fc.Xb(2)};p.NZb=function(){ePd(this)};p.hBb=function(){var a=this.J.isChecked();dhc(this.eb,a)};p.hrb=function(){ePd(this)};p.eBb=function(){this.L.isChecked()&&this.R.Dc(!0);this.tna()};
p.MZb=function(a){var b=fPd;if("findNext"==a.key)a.preventDefault(),this.Pb&&(A2(this,null),gPd(this,b.Nua));else if("replace"==a.key)a.preventDefault(),this.Hb&&(A2(this,null),gPd(this,b.Uva));else if("replaceAll"==a.key&&(a.preventDefault(),this.Qb)){a=v(function(){A2(this,null);gPd(this,b.Tva)},this);var c=this.F.Ze().kb();1<this.sb.D.length&&2==c&&!this.Eb?(QBc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Eb=!0):a()}};
p.tna=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Yp(this.D,"findNext").disabled=!a;this.Pb=a;hPd(this,a);this.Hb&&!a&&iPd(this,!1);Vh(this.C,"waffle-input-error",b)};p.LZb=function(a,b,c){this.pb=a.Ir();gqb(this.Hc,this,a,b,c,!1,!0)};
function ePd(a){var b=0==a.F.Ze().kb();a.O.setVisible(b);C(a.Aa);a.Aa=null;var c=dPd(a),d=ED(a.jb);b&&d&&c&&(a.Aa=nL(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.Aa.setVisible(!0),a.Ba(a.Aa))}function gPd(a,b){if(0==a.F.Ze().kb()&&null==dPd(a))Vh(a.O.D,"waffle-range-selection-error",!0),A2(a,"Invalid range");else{var c=a.F.Ze().kb();a.dispatchEvent(new jPd(b,a.C.value,a.Na.value,c,a.R.isChecked(),a.Ea.isChecked(),a.L.isChecked(),a.J.isChecked(),dPd(a)))}}
p.setVisible=function(a){var b=this.eb.Qd();hPd(this,!b);iPd(this,!b);this.Na.disabled=b;aPd.oa.setVisible.call(this,a);a&&this.pb&&(this.pb.focus(),this.pb=null)};p.WTb=function(a){this.C.value=a};p.QQa=function(){this.C.select()};p.focus=function(){this.Rb()&&this.isVisible()&&(this.C.focus(),this.fc.Xb(2),Xr(this.C,this.C.value.length),this.tna())};function iPd(a,b,c){b=b&&!a.eb.Qd()&&0==!a.C.value.length;a.Hb=b;a=Yp(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function hPd(a,b){b=b&&!a.eb.Qd()&&0==!a.C.value.length;a.Qb=b;Yp(a.D,"replaceAll").disabled=!b}function A2(a,b){var c=Sd(a.Sb());a=a.xb;b?(0<re(a).length&&c.appendChild(a,c.Da("BR")),c.appendChild(a,c.Da("B",null,Ke(c,b)))):c.Ed(a)}p.Ha=function(){aPd.oa.Ha.call(this);this.Eb=!1;dhc(this.eb,this.Jb)};function jPd(a,b,c,d,e,f,h,k,l){D.call(this,a);this.F=b;this.H=c;this.C=d;this.O=e;this.R=f;this.ma=h;this.Ga=k;this.La=l||null}x(jPd,D);
var fPd={Nua:"findnext",edc:"findall",Uva:"replace",Tva:"replaceall",DONE:"done",g6b:"canceled"};function kPd(a,b,c,d,e){A.call(this);var f=fPd;this.F=null;this.C=a;this.D=b;this.H=c;this.O=d;this.L=e;this.J=new Yh(this);this.Ba(this.J);this.J.V(a,f.Tva,this.hAb).V(a,f.Uva,this.iAb).V(a,f.Nua,this.sUa).V(a,f.DONE,this.mpb)}x(kPd,A);var B2={aO:"cg",bO:"cr",$N:"cc",Mua:"loop"};p=kPd.prototype;p.SVb=function(){this.C.setVisible(!0);lPd(this,null)};p.sUa=function(a){if(FD(this.D.C)){var b=ED(this.D).kb(),c=this.F;c||(c=AF(b),c=Dc(B2.aO,b.Bc(),B2.bO,b.O.C[c.y],B2.$N,b.ye.C[c.x]));mPd(this,a,b,c)}};
function mPd(a,b,c,d){var e=new Zu,f=nPd(b);oPd(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.zd((new Vdb).Ca(),a);a=V(f,1);var d=b.type;FD(this.D.C)&&(c?Ru(c,1)?(d=V(c,1),c=Dc(B2.aO,d.Ib(),B2.bO,d.yp(),B2.$N,d.getColumnIndex(),B2.Mua,V(c,2)),pPd(this,a,c)):(pPd(this,a,{}),"replace"==d&&this.C.focus()):qPd(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function oPd(a,b,c){if(c){var d=c[B2.aO],e=new kw;X(e,1,d);X(e,2,SNd(b,c[B2.bO],"r"));X(e,3,SNd(b,c[B2.$N],"c"));X(a,10,e)}}
function nPd(a){var b=new sC;X(b,1,a.F);X(b,3,a.H);X(b,5,a.C);if(0==a.C||1==a.C){var c=a.La,d=new ov;X(d,1,c.C);var e=c.rect.yc();X(d,2,e);pv(d,c.rect.ad());d.Cr(c.rect.Ac());d.Tx(c.rect.hd());b.setSelection(d)}X(b,6,a.O||!1);X(b,7,a.R||!1);X(b,8,a.ma||!1);b.setType(a.Ga?1:0);X(b,11,0);return b}function pPd(a,b,c){c?c&&null!=c.cg?(b=c[B2.aO],c[B2.Mua]&&A2(a.C,"No more results found, looping around"),a.H.ZD(b,v(a.KZb,a,c))):(lPd(a,null),A2(a.C,"There are no entries matching "+b)):qPd(a)}
p.KZb=function(a){var b=ED(this.D).kb(),c=a[B2.bO],d=a[B2.$N];a[B2.bO]=b.O.C[c];a[B2.$N]=b.ye.C[d];lPd(this,a);a=new Kd(d,c);b=new Mw(b.Bc(),vw(a));LR(this.H,b,v(this.f3a,this,a))};
p.f3a=function(a){if(!this.isDisposed()){this.C.focus();var b=ED(this.D).kb();RE(b.gh(a.y,a.x))&&!this.C.J.isChecked()&&iPd(this.C,!1,"Can't replace formula");var c=lF(b,a.y),d=mF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=aG(a),a=SE(uF(b,a)),A2(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function qPd(a){A2(a.C,null);A2(a.C,"Error while searching spreadsheet. Please try again.")}
p.iAb=function(a){if(!this.L.Qd()){var b=this.F;if(b){var c=NE(this.H,b[B2.aO]);if(c){var d=c.Lc(),e=SNd(d,b[B2.bO],"r"),f=SNd(d,b[B2.$N],"c");c=d.gh(e,f);if(!RE(c)||this.C.J.isChecked()){c=SE(c);var h=new Zu,k=nPd(a);X(k,5,0);oPd(k,d,b);d=new ov;X(d,1,b[B2.aO]);X(d,2,e);pv(d,e+1);d.Cr(f);d.Tx(f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);rPd(this,k,c,b,!1);this.sUa(a)}}}}};p.hAb=function(a){if(!this.L.Qd()&&FD(this.D.C)){var b=nPd(a);rPd(this,b,a.F,a.H,!0)}};
function rPd(a,b,c,d,e){b=new rNc(b);yD(b,v(function(a,b){a?(a=V(b,5),b=V(b,4),b=0==a?"No matches found":e?(new As(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),A2(this.C,null),A2(this.C,b)):qPd(this)},a));A2(a.C,null);A2(a.C,"Working...");a.O.C(b)}p.mpb=function(){lPd(this,null)};function lPd(a,b){a.F=b;(a=a.C)&&iPd(a,null!=b)};function sPd(a,b,c){WNd.call(this);Jp(this,"Grouping rule");this.Aa=a;this.Na=b;this.Ea=c;this.R=new M;this.Ia(this.R,!0);this.F=new tPd("Minimum value","e.g. 0",!0);this.R.Ia(this.F,!0);this.L=new tPd("Maximum value","e.g. 100",!0);this.R.Ia(this.L,!0);this.J=new tPd("Interval size","e.g. 10",!1);this.Ia(this.J,!0);(a=this.Aa.C.getActiveGrid())&&(a=OF(a.Lc()))&&(a=uPd(this,a))&&Ru(a,10)&&Ru(Ix(a),3)&&(a=V(Ix(a),3),Ru(a,1)&&(b=V(a,1),this.F.D.fb(lU.format(b))),Ru(a,2)&&(b=V(a,2),this.J.D.fb(lU.format(b))),
Ru(a,3)&&(a=V(a,3),this.L.D.fb(lU.format(a))))}q(sPd,WNd);
sPd.prototype.c8=function(){var a=vPd(this.F),b=vPd(this.J),c=vPd(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(wPd(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(wPd(this.F,"Value too large"),d=!1):d=!0;if(d){d=new Jx;d.setType(2);var e=new Mx;null!=a&&X(e,1,a);null!=b&&X(e,2,b);null!=c&&X(e,3,c);X(d,3,e);if(a=this.Aa.C.getActiveGrid())if(a=a.Lc(),b=OF(a))if(c=uPd(this,b))X(c,10,d),this.Na.C(new FM(b,a)),Oz("Pivot table headings grouped.");WNd.prototype.c8.call(this)}};
function uPd(a,b){b=Slb(b,function(b){return b.iY()==a.Ea});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return Ru(b[0],10)?b[0]:b[1]}function tPd(a,b,c,d){M.call(this,d);this.L=a;this.O=b;this.R=c;this.J=new M;this.Ia(this.J,!0);this.D=new MT;this.Ia(this.D,!0);this.H=null;this.C=new M;this.Ia(this.C,!0);this.F=new hS(this.va(),!0,!0);this.Ba(this.F)}q(tPd,M);
tPd.prototype.Ja=function(){M.prototype.Ja.call(this);this.Pa().className="waffle-pivot-histogram-errorable-input";this.J.Pa().className="waffle-pivot-histogram-dialog-caption";this.va().Pe(this.J.getElement(),this.L);this.H=this.D.Sd().mM(this.D.Pa());this.H.placeholder=this.O;Ph(this.H,this.L+" - "+this.O);kS(this.F,this.H);this.C.Pa().className="waffle-pivot-histogram-dialog-error";Kh(this.C.Pa(),"alert");Lh(this.C.Pa(),"live","polite");xPd(this)};
function vPd(a){xPd(a);var b=a.D.getValue();if(Jb(b)){if(a.R)return null;wPd(a,"Required");return NaN}b=lU.parse(b);isNaN(b)&&wPd(a,"Must be a number");return b}function wPd(a,b){a.C.Pa().style.visibility="";a.va().Pe(a.C.Pa(),b);iS(a.F,b,!1)}function xPd(a){a.C.Pa().style.visibility="hidden";jS(a.F)};function yPd(a){a=a||{};var b=a.type;return P('<input class="'+Q("jfk-textinput")+(a.Id?" "+Q(a.Id):"")+'"'+(a.id?' id="'+Q(a.id)+'"':"")+(a.maxLength?' maxlength="'+Q(a.maxLength)+'"':"")+(a.V$&&a.sXb?' label="'+Q(a.V$)+'"':"")+(a.name?' name="'+Q(a.name)+'"':"")+(a.V$?' placeholder="'+Q(a.V$)+'"':"")+' type="'+Q(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+Q(a.pattern)+'"':"")+(a.value?' value="'+Q(a.value)+'"':"")+(a.dir?' dir="'+Q(a.dir)+'"':"")+(a.attributes?" "+MEa(a.attributes):"")+">")};function zPd(a){a=""+APd({id:"waffle-resize-selection-custom",dLa:a.Fha,Ok:yq("<br/>"+O(yPd({id:"waffle-resize-input",Id:"waffle-resize-inset-input"})))});a+=APd({id:"waffle-resize-selection-auto",dLa:xq("Fit to data"),Ok:yq("")});return P(a)}function APd(a){return P('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+Q(a.id)+'"><label for="'+Q(a.id)+'" class="waffle-resize-label">'+O(a.dLa)+"</label>"+O(a.Ok)+"</div>")}
function BPd(a){var b=a.hdb;a='<label for="waffle-resize-input">'+O(a.Fha)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return P(a)};function CPd(a,b,c,d,e){Ip.call(this);this.L=a;this.Ea=b;var f=Ew(this.L.Sc());this.C=f;this.F=Va(wF(this.L),function(a){return Ew(a)==f});this.J=new yO;this.O=new nNc(!0);this.R=new Ys;this.Na=c;this.eb=d;this.Aa=e}x(CPd,Ip);var DPd={AUTO:"waffle-resize-selection-auto",jo:"waffle-resize-selection-custom",cva:"waffle-resize-input",l_a:"waffle-resize-selection",p0a:"waffle-resize-rows-can-grow-checkbox"};p=CPd.prototype;
p.Da=function(){CPd.oa.Da.call(this);var a=this.F[0];if("r"==this.C){var b=a.yc();a=a.ad()-1;var c=String(VF(b+1)),d=String(VF(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.Ac(),a=a.hd()-1,c=XF(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+XF(a)));Jp(this,b);"r"==this.C?this.Sb().appendChild(N(BPd,{Fha:EPd(this),hdb:Eh(H(),"fefrh")})):this.Sb().appendChild(N(zPd,{Fha:EPd(this)}));hq(this,
"ok")};p.Ja=function(){CPd.oa.Ja.call(this);var a=this.va(),b="r"==this.C;this.J.qb(a.getElement(DPd.cva));Eh(H(),"fefrh")&&b&&(a=a.getElement(DPd.p0a),Ws(this.R,a),Ni(this.R,a));a=this.L.Sc();var c=Ew(a);a=Nhb(lnb(this.L,c,Cw(a,c)));this.J.fb(String(a));b||(oNc(this.O,DPd.l_a),pNc(this.O,DPd.jo));this.getHandler().V(this,"dialogselect",this.SZb).V(this.J.getElement(),"focus",this.hFb)};p.hFb=function(){"c"==this.C&&pNc(this.O,DPd.jo)};p.focus=function(){this.Rb()&&BO(this.J)};
function EPd(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(YE+")"):"Enter new column width in pixels. (Default: "+(Phb+")")}
p.SZb=function(a){if("ok"==a.key)if((a="r"==this.C)||qNc(this.O)==DPd.jo){var b=parseInt(this.J.getValue(),10);isNaN(b)?Nz("Entered value is not a number."):2>b||2E3<b?Nz("Size must be between 2 and 2000 pixels."):(this.Aa.Mb("r"==this.C?35310:35308,void 0),b=new PM(this.L,this.F[0],b,this.F.slice(1)),Eh(H(),"fefrh")&&a&&(a=!this.R.isChecked(),b.L=a),this.Ea.C(b))}else ED(this.Na),this.Aa.Mb(35307,void 0),wZb(this.F,this.eb,this.Ea)};function FPd(a){Xf(this,a,0,-1,null,null)}x(FPd,Wf);FPd.prototype.getType=function(){return F(this,3)};FPd.prototype.setType=function(a){G(this,3,a)};function GPd(a){M.call(this,a);this.ma=Az("email");this.C=this.D=null}x(GPd,M);p=GPd.prototype;
p.Da=function(){var a=this.va();var b=this.va();this.C=new fT;this.Ba(this.C);this.D=new fT;this.Ba(this.D);var c=b.Da("DIV","waffle-dialog-notifications-input");Kh(c,"presentation");this.F=new dT;eT(this.F,b.Da("LABEL",null,"Any changes are made"));this.F.render(c);this.C.gH(this.F);var d=b.Da("DIV","waffle-dialog-notifications-input");Kh(d,"presentation");this.J=new dT;eT(this.J,b.Da("LABEL",null,"A user submits a form"));this.J.render(d);this.C.gH(this.J);var e=b.Da("DIV","waffle-dialog-notifications-input");
Kh(e,"presentation");this.H=new dT;eT(this.H,b.Da("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.gH(this.H);var f=b.Da("DIV","waffle-dialog-notifications-input");Kh(f,"presentation");this.L=new dT;eT(this.L,b.Da("LABEL",null,"Email - right away"));this.L.render(f);this.D.gH(this.L);b=b.Da("DIV",null,b.Da("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.ma+" when...")),b.Da("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.ma+" when...")},c,d),b.Da("DIV",
{style:"padding: 5px"}),b.Da("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Da("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.va();d=c.Da("DIV");this.O=CP("Save",c);this.Ia(this.O,!1);this.O.render(d);this.R=new Gq("Cancel",c);this.Ia(this.R,!1);this.R.render(d);a=a.Da("DIV","waffle-dialog-notifications",a.Da("DIV",null,b),a.Da("DIV",null,d));this.Lb(a)};
p.Ja=function(){GPd.oa.Ja.call(this);this.getHandler().V(this.O,"action",this.dTb,!0).V(this.R,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).V(this.C,"change",this.wta).V(this.D,"change",this.wta)};p.Ec=function(a){GPd.oa.Ec.call(this,a);a?1==a.getType()?gT(this.C,this.F):2==a.getType()&&gT(this.C,this.J):gT(this.C,null);a?2==F(a,2)?gT(this.D,this.H):1==F(a,2)&&gT(this.D,this.L):gT(this.D,null);this.wta()};p.focus=function(){var a=hT(this.C),b=this.C.C.We(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.dTb=function(){this.dispatchEvent(new D("saveRule",HPd(this)))};function HPd(a){var b=new FPd,c=a.kb();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.wta=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.$a(a)};function IPd(a){return P("<div><div>"+O(a.t5a)+"</div>"+O(Xs({id:"waffle-confirm-suppress-checkbox",Id:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+O(a.ysa)+"</span></div>")};function JPd(a,b,c,d,e,f,h){if(ya(c)){var k=new Up;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=SDa;return KPd(d||"Heads up!",a,b,k,e,f,h)}function KPd(a,b,c,d,e,f,h){b=pd(b);if(f){b=lq(IPd({t5a:b,ysa:f}));var k=new Ys;var l=c;c=function(){l(k.isChecked())}}a=iEa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ia(k),k.qb(Ge(a.va(),"waffle-confirm-suppress-checkbox")),c=Ge(a.va(),"waffle-confirm-suppress-label"),Ws(k,c),k.Dc(!1));return a};function C2(a,b){M.call(this,b);this.Ec(a)}x(C2,M);
C2.prototype.Da=function(){var a=this.kb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.va();a=d.Da("TD",null);b=d.Da("TD",{width:"50px"});c=d.Da("TR",{valign:"center"},d.Da("TD",null,d.Da("SPAN","waffle-notification-rule",c)),d.Da("TD",{align:"right"},d.Da("TABLE",null,d.Da("TBODY",null,d.Da("TR",null,a,b)))));d=Ui(qq,"waffle-notifications-add");this.D=new rq("Edit",
d,this.va());this.D.Md("goog-link-button");this.D.Md("menuMainLink");this.Ia(this.D,!1);this.D.render(a);this.C=new rq("Delete",d,this.va());this.C.Md("goog-link-button");this.C.Md("menuMainLink");this.Ia(this.C,!1);this.C.render(b);this.Lb(c)};C2.prototype.Ja=function(){C2.oa.Ja.call(this);this.getHandler().V(this.D,"action",this.H);this.getHandler().V(this.C,"action",this.F)};C2.prototype.H=function(){this.dispatchEvent(new D("edit",this.kb()))};
C2.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.kb()))},this),b=v(function(){this.C.getElement().focus()},this);JPd("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function LPd(a){M.call(this,a);this.C=null}x(LPd,M);LPd.prototype.Da=function(){var a=this.va();this.C=a.Da("TBODY");a=a.Da("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C);this.Lb(a)};LPd.prototype.Sb=g("C");LPd.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function MPd(a,b,c){Ip.call(this);this.L=b;Jp(this,"Set notification rules");Tp(this,!1);a=new Up;a.set("cancel","Done",!1,!0);Xp(this,a);this.C=new GPd(c);this.Ia(this.C,!1);this.F=new LPd;this.Ia(this.F,!1);this.J=new rq("Add another notification rule",dN.getInstance(),this.va());this.Ia(this.J,!1)}x(MPd,Ip);p=MPd.prototype;
p.Da=function(){MPd.oa.Da.call(this);var a=this.va(),b=VNd(new Hl(M5a+"91588")).toString();b=a.Da("A",{target:"_blank",href:b},"Help");var c=a.Da("DIV");this.J.render(c);this.R=a.Da("DIV");this.O=a.Da("DIV");var d=a.Da("DIV","waffle-dialog-notifications-bounds",this.R,this.O);b=a.Da("DIV",null,a.Da("DIV",{align:"right"},b),d,c);a.appendChild(this.Sb(),b);hq(this,"")};
p.Ja=function(){MPd.oa.Ja.call(this);this.F.render(this.R);this.C.render(this.O);this.getHandler().V(this,"edit",this.VZb).V(this,"del",this.UZb).V(this.J,"action",this.TZb).V(this,"saveRule",this.cTb).V(this,"cancelRuleEdit",this.D4a)};p.O_=function(a){this.isDisposed()||(this.C.setVisible(!1),NPd(this,!1),qz(this.L,"/notifications/list",v(this.aXb,this,a)).He())};
p.aXb=function(a,b,c){if(!this.isDisposed()){b=c.ef();c=[];for(var d=0;d<b.length;d++)c[d]=new FPd(b[d]);this.Ec(c);if(a&&0==c.length)OPd(this,null,!1);else{if(a=this.kb())if(b=this.F,b.Ed(!0),b.va().Ed(b.Sb()),b.Ec(a),c=b.va(),0==a.length)c.appendChild(b.Sb(),c.Da("TR",null,c.Da("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ia(new C2(a[d],c),!0);NPd(this,!0);this.focus()}}};
p.cTb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?$s(qz(this.L,"/notifications/set",v(this.O_,this,!1)),{rule:b}).He():$s(qz(this.L,"/notifications/create",v(this.O_,this,!1)),{rule:b}).He()};p.D4a=function(){this.C.setVisible(!1);this.O_(!1)};p.VZb=function(a){OPd(this,a?a.target:null,!0)};p.TZb=function(){OPd(this,null,!0)};function OPd(a,b,c){NPd(a,!1);var d=a.C;d.Ec(b);d.setVisible(!0);c&&a.C.focus()}
p.UZb=function(a){this.F.setVisible(!1);a=a.target;$s(qz(this.L,"/notifications/delete",v(this.O_,this,!1)),{rule_id:F(a,1)}).He()};function NPd(a,b){a.F.setVisible(b);var c=Qp(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.O_(!0)};function PPd(a,b,c,d,e){xD.call(this,68);this.O=a;this.L=b;this.D=c;this.H=d;this.C=e}x(PPd,xD);PPd.prototype.Wd=function(){var a=new dD;this.O&&X(a,1,this.O);t(this.L)&&X(a,2,this.L);t(this.D)&&X(a,3,this.D);this.H&&X(a,4,this.H);t(this.C)&&X(a,5,this.C);return a};PPd.prototype.l_=function(a,b){(t(this.D)||t(this.H)||t(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);PPd.oa.l_.call(this,a,b)};function QPd(a,b,c){b=c||b;c='<tr class="dialog-settings-general-settings-div"><div>';var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(O(a.y6a)+"</a>");c=c+d+"</div>";a.RUb&&(c+='<div class="dialog-settings-english-name-div">'+O(Xs({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
c+="Always use English function names</label></div>");return P(c+"</tr>")}function RPd(){return P('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function D2(a,b,c,d){Ip.call(this);this.Pb=a;this.Uc=b;this.R=c;this.wc=d;this.C={};this.Hb=this.sb=!1;this.fc=this.Jb=this.Eb="";this.Hc=new Zu;this.J=[];this.F=this.Hc.zd((new dw).Ca(),ritz_api.RitzModelApi.getWorkbookProperties());Jp(this,"Settings for this spreadsheet");this.pb=!1;this.eb=new Ys;this.Ia(this.eb);this.O=new hS;this.Ia(this.O);this.L=new hS;this.Ia(this.L);this.xb=new BS;this.Ia(this.xb);this.Na=this.jb=null;this.Qb=new ys(1);this.Aa=this.Ea="";this.C[0]=t2();this.C[1]=t2();this.C[2]=
t2();this.C[3]=t2();this.C[4]=new yO;this.C[5]=new yO}x(D2,Ip);var SPd=null,TPd={f3:0,M1a:1,AVa:2,RYa:3,rZa:4,EWa:5},UPd={r2a:"waffle-settings-dialog-english-name-checkbox",s2a:"waffle-settings-dialog-english-name-checkbox-label"},VPd=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],WPd=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=D2.prototype;
p.Da=function(){D2.oa.Da.call(this);var a=this.Sb(),b=this.va(),c=[XPd(b,"Locale","waffle-settings-label-locale"),YPd(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),ZPd(this),XPd(b,"Time zone","waffle-settings-label-timezone"),YPd(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
ZPd(this)],d=[];d.push(XPd(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(YPd(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(ZPd(this));d.push(XPd(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=VNd(new Hl(M5a+"58515")).toString();e=b.Da("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(YPd(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=XPd(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=YPd(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");$Pd(e);d.push(e);this.J.push(e);e=XPd(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=YPd(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");$Pd(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Ze().getValue()&&aQd(this);d.push(ZPd(this));c=lb(c,d);c.push(N(QPd,{y6a:this.Jb,RUb:this.pb}));this.jb=b.Da("TABLE","dialog-settings",b.Da("TBODY",null,c));this.Na=b.Da("table","dialog-settings",b.Da("tbody",null,d));c=N(RPd);b.appendChild(a,c);this.xb.qb(c);
b.appendChild(a,this.jb);b.appendChild(a,this.Na);L(this.Na,!1);SPd||(a=new Up(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),SPd=a);Xp(this,SPd);bQd(this,4,Ru(this.F,3)&&V(this.F,3).H8()?V(this.F,3).s6().toString():"50");bQd(this,5,Ru(this.F,3)&&V(this.F,3).D8()?V(this.F,3).f6().toString():"0.05");hq(this,"save")};function $Pd(a){a=a.firstChild.firstChild;J(a,"jfk-textinput");gi(a,"width","7em")}function aQd(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function XPd(a,b,c){return a.Da("TR",null,a.Da("TD",{id:c,"class":"dialog-settings-label"},b))}function YPd(a,b,c,d,e,f,h){b=b.Da("TR",null,b.Da("TD","dialog-settings-input"),b.Da("TD",{id:f,"class":"dialog-settings-text"},c,h||null));a=a.C[d];a.render(b.firstChild);a=a.Pa();Lh(a,"labelledby",e);Lh(a,"describedby",f);return b}function ZPd(a){a=a.va();return a.Da("TR",null,a.Da("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Da("HR",{"class":"dialog-settings-sep"})))}
p.Ja=function(){D2.oa.Ja.call(this);mf(this,"dialogselect",v(this.WZb,this));this.getHandler().V(this.C[3],"action",this.fVb);this.getHandler().V(this.xb,"select",this.MDb);var a=this.C[4].getElement();this.O.vj(a);kS(this.O,a,a);this.O.render();jS(this.O);this.getHandler().V(a,"change",v(this.xXb,this));a=this.C[5].getElement();this.L.vj(a);kS(this.L,a);this.L.render();jS(this.L);this.getHandler().V(a,"change",v(this.wXb,this));if(this.pb){a=this.va().getElement(UPd.r2a);var b=this.va().getElement(UPd.s2a);
this.eb.qb(a);Ws(this.eb,b);this.eb.Dc(!X5a||Kvb(this.R.F))}};p.setVisible=function(a){if(a){if(!this.sb){cQd(this);return}var b=this.R.L;bQd(this,0,b.C);b=b.H||C4b().name();bQd(this,1,b);bQd(this,2,Ru(this.F,3)&&V(this.F,3).Kma()?V(this.F,3).tja().toString():"");bQd(this,3,Ru(this.F,3)&&Ru(V(this.F,3),1)?V(V(this.F,3),1)?"ON":"OFF":"OFF")}D2.oa.setVisible.call(this,a);this.sb&&!this.Hb&&((a=Vd("ds-settings-link"))&&wd(a,this.Eb),this.Hb=!0)};
function cQd(a){Lr(tt(a.Uc.jf("/info/settings"),dQd()),v(function(a){a=a.ef();(a={locale:a.l?this.tK(a.l):null,dTa:a.tz?this.tK(a.tz):null,H6a:a.dls,JIb:a.dln,uXb:a.hl},a.locale)&&a.dTa&&(eQd(this,0,a.locale),eQd(this,1,a.dTa),eQd(this,2,VPd),eQd(this,3,WPd),this.Eb=a.H6a,this.Jb=a.JIb,this.fc=a.uXb,this.pb=X5a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.fc),this.sb=!0);this.setVisible(!0)},a)).He()}
function dQd(){var a=Sl(Az("win").location.href),b=Ql(a,"hl");a=Ql(a,"forcehl");return["hl",b,"forcehl",a]}function eQd(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Sk(e.caption,e.value);a.yd(e);Kh(e.getElement(),"menuitem")}a.zc().getElement().style.overflow="auto";Rq(a,!0)}p.tK=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function bQd(a,b,c){(a=a.C[b])&&a.fb(c)}
p.WZb=function(a){"save"==a.key&&("ON"!=this.C[3].Ze().getValue()||""==this.Ea&&""==this.Aa?(fQd(this),a=this.R.L.C,this.Pb.C(gQd(this)),this.Pb.C(hQd(this)),iQd(this,a)):(a.preventDefault(),fQd(this),""!=this.Ea&&iS(this.O,this.Ea,!0),""!=this.Aa&&iS(this.L,this.Aa,!0)))};p.fVb=function(a){if("ON"==a.target.getValue())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else aQd(this);fQd(this)};function fQd(a){jS(a.O);jS(a.L)}
p.xXb=function(){this.Ea="";var a=this.C[4].getValue()||"";a=this.Qb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ea="Please enter an integer value.";else if(0>=a||1E4<a)this.Ea="Please enter a value between 1 and 10000."};p.wXb=function(){this.Aa="";var a=this.C[5].getValue()||"";a=this.Qb.parse(a);isNaN(a)?this.Aa="Please enter a numeric value.":0>a&&(this.Aa="Please enter a non-negative value.")};
p.MDb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.jb,!0);L(this.Na,!1);break;case "calculation-settings-tab":L(this.jb,!1),L(this.Na,!0)}};function gQd(a){var b=a.C,c=b[TPd.AVa].Ze().getValue(),d=b[TPd.RYa].Ze().getValue();a=b[TPd.rZa].getValue()||"";b=b[TPd.EWa].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new PPd(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function hQd(a){var b=a.C;a=a.R.L;var c=b[TPd.f3].Ze();c=null==c?a.C:c.getValue();b=b[TPd.M1a].Ze();b=null==b?a.H||C4b().name():b.getValue();return new K4b(c,b)}function jQd(a,b){a=a.C[0].Ze();return null!=a&&a.getValue()!=b}function iQd(a,b){(kQd(a)||jQd(a,b))&&Dqa(a.R.D.C,function(){Az("win").location.reload()})}function kQd(a){if(!a.pb)return!1;var b=!X5a||Kvb(a.R.F),c=a.eb.isChecked();return b!=c?(Svb(a.R,c),b=Uj(new Tj,1).build(),a.wc.Mb(c?2433:2434,b),!0):!1}
p.Ha=function(){ic(this.C,C);delete this.C;D2.oa.Ha.call(this)};function lQd(a,b,c,d,e,f,h,k){Ip.call(this,void 0,!1,k);this.J=this.L=this.R=this.O=null;this.Na=a;this.C=b;this.Aa=h;this.F=[];this.Ea=new Plc(a,d,e,f)}q(lQd,Ip);p=lQd.prototype;
p.Da=function(){Ip.prototype.Da.call(this);var a=this.va(),b=this.C.Sc(),c=aG(Jw(b)),d=aG(new Kd(b.left+b.width-1,b.top+b.height-1));Jp(this,"Sort range from "+(c+(" to "+d)));mQd||(c=new Up,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),mQd=c);Xp(this,mQd);hq(this,"save");var e;c=a.Da("DIV",{style:"overflow: hidden"},d=a.Da("SPAN","jfk-checkbox"),e=a.Da("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.J=new Ys(void 0,a);f.qb(d);Ws(f,e);1==b.height&&f.$a(!1);aI(this.Na,this.C.Bc(),
b)||(f.Dc(!0),f.$a(!1));Eh(H(),"fetdrisd")&&ritz_api.TablesApi.getTables((new Zu).serialize(Qw(b,this.C.Bc())),v(function(a){if(0<a.length){var c=a[0];a=xP(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c)&&1==R_a(Ow(a)))c=Qw(b,this.C.Bc()),c=a.Ib()==c.Ib()&&N_a(Ow(a),Ow(c))&&N_a(Pw(a),Pw(c));c&&f.Dc(!0)}},this));d=this.Sb();a.appendChild(d,c);this.O=a.Da("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Da("TABLE",{cellSpacing:"0"},this.R=a.Da("TBODY")));
a.appendChild(d,this.O);c=nQd(this);this.F.push(c);c=a.Da("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);Ae(c,!0);Kh(c,"button");this.L=c};p.Ja=function(){Ip.prototype.Ja.call(this);this.getHandler().V(this,"dialogselect",this.CKb).Cg(this.L,pf,this.Hjb).V(this.J,"change",this.osb)};
function nQd(a){var b=a.va(),c=0==a.F.length,d=new oQd(a,c,a.C,a.F.length,b),e=b.Da("TR",null,b.Da("TD",{colspan:"4"},b.Da("DIV","waffle-sd-row-separator")));d.render(a.R);b.appendChild(a.R,e);c||a.getHandler().Cg(d.D,pf,v(a.d6a,a,d));a=pQd(a);qQd(d,a);return d}p.d6a=function(a){var b=this.F;if(1<b.length){var c=Ta(b,a);-1!=c&&(jb(b,c),b=a.getElement(),b=te(b),a.dispose(),pe(b),L(this.L,!0),this.L.focus(),Oz("Sort criteria removed."))}};
function pQd(a){var b=a.C.Sc(),c=b.Ac();b=b.hd();var d=Wa(a.F,function(a){return a.Zj()},a);if(d)for(var e=Anb(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.ye.C[f];if(!bb(d,h))return h}return null}p.osb=function(){for(var a=this.F,b=0;b<a.length;b++)qQd(a[b])};p.Hjb=function(){var a=Iw(this.C.Sc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(nQd(this)),Oz("Sort criteria added."));ui(Sa(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.L,!1)};
p.CKb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Zj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Sc();d=Iw(c,"r");this.J.isChecked()&&1<d&&(c=I_a(c,-1));d=Uj(new Tj,1).build();this.Aa.Mb(this.J.isChecked()?35697:35698,d);a=new Olc(a,b,this.C,c,this.J.isChecked());Qlc(this.Ea,this.C,a)}};p.Ha=function(){Ip.prototype.Ha.call(this);Cb(this.F)};var mQd=null;
function oQd(a,b,c,d,e){M.call(this,e);this.H=this.L=this.F=this.C=this.D=null;this.R=-1;this.ma=a;this.O=b;this.J=c}q(oQd,M);oQd.prototype.Zj=function(){var a=this.C.Ze();return a?a.getValue():-1};
oQd.prototype.Da=function(){var a=this.va(),b=this.O?"sort by":"then by",c,d,e,f=a.Da("TR","waffle-sd-tr-rules",a.Da("TD","waffle-sd-delete",this.O?"":this.D=a.Da("SPAN",{title:"Remove sort criteria."},"x")),a.Da("TD","waffle-sd-td-rules",a.Da("LABEL",{id:Oi(this,"csl")},b)),b=a.Da("TD","waffle-sd-column-selector"),a.Da("TD","waffle-sd-td-ascending",e=a.Da("DIV",null,c=a.Da("DIV",{title:"Ascending"}),d=a.Da("DIV",{title:"Descending"}))));Kh(e,"radiogroup");e=this.F=new dT(a,Le(a,Qo(pC(!0,this.re()))),
"ascending");e.render(c);a=this.L=new dT(a,Le(a,Qo(pC(!1,this.re()))),"descending");a.render(d);this.H=new fT([e,a]);gT(this.H,e);a=this.C=t2();a.render(b);Lh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(Ae(this.D,!0),Kh(this.D,"button"),Ph(this.D,"Remove sort criteria."));this.Lb(f)};
function qQd(a,b){var c=a.va(),d=a.ma.J.isChecked(),e=a.J.Sc(),f=e.yc(),h=e.Ac();e=e.hd();a.R=b||a.Zj();for(b=a.C.Mh();0<b;b--)a.C.xz(0);for(;h<e;h++)b=Tb(SE(a.J.gh(f,h)),25),b=new Sk(Jb(b)||!d?"Column "+XF(h):b,a.J.ye.C[h],c),b.Md("waffle-sd-menu-item"),a.C.yd(b);a.C.$e(0);0<=a.R&&a.C.fb(a.R)}oQd.prototype.Ha=function(){M.prototype.Ha.call(this);this.C=this.D=this.J=this.ma=null;C(this.F);C(this.L);C(this.H);this.H=this.L=this.F=null};function rQd(a,b,c){return hEa(a||"There was a problem",pd(b),void 0,void 0,void 0,void 0,c)};function sQd(a){return P("<li class='nfd-format-pill'><div class='nfd-format-display'>"+O(a.ieb)+"</div><div class='nfd-format-sample'>"+O(a.rSb)+"</div></li>")};function tQd(a,b,c){M.call(this);this.Ec(a);this.D=b;this.C=c}x(tQd,M);p=tQd.prototype;p.Da=function(){var a=this.kb(),b=this.C?fba(a.fz(),30):a.fz();a=this.C?Xgc(a,this.D):"";b=N(sQd,{ieb:b,rSb:a});this.Lb(b)};p.Ja=function(){tQd.oa.Ja.call(this);Ae(this.getElement(),!0);var a=new tk(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.i_b).V(this.getElement(),"mousedown",this.h_b).V(this.getElement(),"dblclick",this.npb)};
p.i_b=function(a){function b(a,b){for(;b=a(b);)if(Di(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(te,this.getElement());break;case 38:b(Xca,this.getElement())}};p.h_b=function(a){a.preventDefault();this.dispatchEvent("change")};p.npb=function(){this.dispatchEvent("action")};function uQd(a,b,c){M.call(this);this.D=b;this.C=c;vQd(this,a)}x(uQd,M);uQd.prototype.Da=function(){var a=this.va().Da("UL","nfd-pill-container");this.Lb(a)};function vQd(a,b){z(b,function(b){a.Ia(new tQd(b,a.D,a.C),!0)})}uQd.prototype.filter=function(a){a=a.toLowerCase();this.qf(function(b){var c=Jb(Yb(a)),d=b.kb().fz().toLowerCase();c=c||Sb(d,a);L(b.getElement(),c)})};function E2(a){Ip.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.aha();this.Ia(this.input,!0);this.J=new M;this.Ia(this.J,!0);a=this.B6();pb(a,void 0,bOd);this.C=new uQd(a,this.pY(),this.cSa());this.J.Ia(this.C,!0);Xp(this,null);this.Ci=!0}x(E2,Ip);p=E2.prototype;p.zUa=Re;p.cSa=Qe;p.isEmpty=function(){return Jb(this.input.getValue())};p.hf=function(){return this.input.kb().hf()};p.Da=function(){E2.oa.Da.call(this);var a=fe("DIV","dialog-separator");oe(a,Pp(this))};
p.Ja=function(){E2.oa.Ja.call(this);J(this.J.getElement(),"nfd-dialog-content");this.getHandler().V(this.C,"change",this.urb).V(this.C,"action",this.xta).V(this.input.O,"action",this.xta).V(this.input,"afterhide",this.Ujb);this.input.R&&this.getHandler().V(this.input.R,"input",this.a_b);var a=this.input.Aa;a&&this.getHandler().V(a,"key",this.b_b);a=this.B6()[0];this.input.hN(a)};p.Ujb=function(a){a.stopPropagation()};p.urb=function(a){this.input.hN(a.target.kb());wQd(this.input,!1)};
p.a_b=function(){this.C.filter(this.input.getValue());wQd(this.input,!this.input.kb().hf())};p.b_b=function(a){13==a.keyCode&&this.xta()};p.xta=function(){this.hf()&&!this.isEmpty()?(q8a.gc(new wP(this.t2(),void 0,this.zUa())),this.setVisible(!1)):(wQd(this.input,!0),this.input.UCa())};function G2(a){M.call(this);this.J=new M;this.Ba(this.J);this.D=new yO("");this.Ba(this.D);this.O=new Gq("");this.Ba(this.O);this.ma=a;this.Aa=null}x(G2,M);p=G2.prototype;
p.Ja=function(){G2.oa.Ja.call(this);var a=Qi(this,"nfd-icwr");this.J.qb(a);this.Ia(this.J);if(a=Qi(this,"nfd-i"))this.D.qb(a),this.D.Ud(this.J),Th(this.D.getElement(),"jfk-textinput"),a=new Ar,a.qb(this.D.getElement()),this.Ba(a),this.R=a=new zr(this.D.getElement()),this.Ba(a),this.Aa=a=new tk(this.D.getElement()),this.Ba(a),a=new Gp(this.D.getElement()),this.getHandler().V(a,"focusout",Ba(this.xUa,!1)).V(a,"focusin",Ba(this.xUa,!0)).V(this.R,"input",this.$Zb);a=Qi(this,"nfd-a");this.O.qb(a);this.Ia(this.O)};
p.getValue=function(){return this.D.getValue()};p.$Zb=function(){var a=this.kb(),b=this.getValue();X(a.FH,2,b);this.yUa()};p.yUa=Re;p.xUa=function(a){Vh(this.J.getElement(),"nfd-input-focus",a)};p.hN=function(a){this.Ec(a.clone());this.D.fb(a.fz());try{this.D.getElement().focus()}catch(b){}};p.UCa=function(){this.D.getElement().focus()};function wQd(a,b){a=a.J.getElement();Vh(a,"nfd-invalid",b)};function xQd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.i_)+"'>"+yQd(a)+"</div>"+zQd(a,b)+"</div>")}function AQd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.i_)+"'></div>"+zQd(a,b)+"</div>")}
function BQd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.i_)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+yQd(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+Q(a.sHb)+"'></div></div></div></div>"+zQd(a,b)+"</div>")}
function CQd(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+DQd({label:""});a+=DQd({label:yq("Negative:")});a+=DQd({label:yq("Zero:")});a+=DQd({label:yq("Text:")});return P(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function DQd(a){return P("<tr><td class='nfd-sample-label'>"+O(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function zQd(a,b){a=""+O(Fq({id:a.eW,style:2,Id:"nfd-apply",content:xq("Apply")},b));return P(a)}function yQd(a){return P(O(yPd({id:a.vKa,V$:a.wKa,sXb:!0})))};function H2(a,b,c,d,e){Sk.call(this,b,c,d,e);this.C=a}x(H2,Sk);H2.prototype.bk=function(){var a=H2.oa.bk.call(this),b=this.getParent();return b&&b instanceof Mk&&!b.isVisible()?this.C(a,this.kb()):a};function EQd(a){G2.call(this,a);this.F=new M;this.C=new $L("")}x(EQd,G2);p=EQd.prototype;p.Da=function(){var a=N(BQd,{i_:Oi(this,"nfd-icwr"),vKa:Oi(this,"nfd-i"),wKa:this.ma,sHb:Oi(this,"nfd-ic"),eW:Oi(this,"nfd-a")});this.Lb(a)};p.Ja=function(){EQd.oa.Ja.call(this);var a=Qi(this,"nfd-ic");this.F.qb(a);this.F.Ud(this.J);this.F.Ia(this.C,!0);this.getHandler().V(this.C,"aftershow",this.c_b).V(this.C,"action",this.BHa).V(this.R,"input",Ba(this.QTa,null))};
p.hN=function(a){EQd.oa.hN.call(this,a);a.C&&this.D.fb(xs[a.C][1]);this.QTa(a)};
p.QTa=function(a){a=a?a.C:void 0;var b=this.C;b.Kf(null);if(a){var c=this.kb(),d=c.C;FQd(this,c);c=Ulc(d,xs[d][2]);c=new wP(GQd(c),Tlc[d],d);FQd(this,c);c=Ulc(d,d+" "+xs[d][1]);d=new wP(GQd(c),Tlc[d],d);FQd(this,d)}else this.kb().C=null;var e="[$"+this.getValue()+"]";d=a?Tlc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new wP(GQd(c[e]),d,a);FQd(this,f)}b.$e(0);this.BHa();J(b.zc().getElement(),"number-format-menu")};function FQd(a,b){var c=new H2(function(a){return fba(a,25)},Xgc(b,1E3),b);a.Ba(c);a.Ba(b);c.Po(!0);a=a.C;for(b=0;b<a.Mh();b++)if(a.We(b).bk()==c.bk())return;a.yd(c)}p.BHa=function(){for(var a=this.C,b=0;b<a.Mh();b++)a.We(b).Dc(!1);a.vA()};p.c_b=function(){this.C.Ze().Dc(!0)};function GQd(a){var b=new ev;X(b,2,a);b.setType(4);return b};function HQd(a){E2.call(this,a);Jp(this,"Custom currencies")}x(HQd,E2);p=HQd.prototype;p.pY=n(1000.12);p.aha=function(){return new EQd("Custom currency")};p.B6=function(){var a=this;Xic();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=Tlc[e]:UNd(d,Wlc(d.Al()))}var f=[];ic(xs,function(b,c){b=Vlc(c);a.Ba(b);f.push(b)});var h=tNc();tb(f,function(a,b){return h(a.fz(),b.fz())});return b.concat(f)};
p.t2=function(){var a=new ev;a.setType(4);X(a,3,1);var b=this.input.C.Ze().getValue().Al();X(a,2,b);return a};p.zUa=function(){return this.input.kb().C};function IQd(a){M.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(IQd,M);IQd.prototype.Da=function(){var a=N(CQd);this.F=$d("nfd-sample-label",a);this.D=Zd("nfd-rendered-sample",a);this.Lb(a)};function I2(a,b){G2.call(this,a);this.C=new IQd(b);this.Ec(new wP(""))}x(I2,G2);I2.prototype.Da=function(){var a=N(xQd,{vKa:Oi(this,"nfd-i"),wKa:this.ma,i_:Oi(this,"nfd-icwr"),eW:Oi(this,"nfd-a")});this.Lb(a)};I2.prototype.Ja=function(){I2.oa.Ja.call(this);this.Ia(this.C,!0);JQd(this)};I2.prototype.yUa=function(){JQd(this)};I2.prototype.hN=function(a){I2.oa.hN.call(this,a);JQd(this)};
function JQd(a){var b=a.kb();if(b){var c=a.C;a=b.Al().split(";").length-1;ye(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=Xgc(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Al()),k=d<=a;L(ve(e),k);ye(e,f);gi(e,"color",h||"")}d=b.hf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Al()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Al());c=c.D[3];L(ve(c),3<=a);ye(c,d);gi(c,"color",b||"")}};function KQd(a){E2.call(this,a);Jp(this,"Custom number formats")}x(KQd,E2);KQd.prototype.pY=n(1234.56);KQd.prototype.aha=function(){return new I2("Custom number format",1234.56)};
KQd.prototype.B6=function(){var a=this.F;a.push(new wP("0"));a.push(new wP("0.00"));a.push(new wP("#,##0"));a.push(new wP("#,##0.00"));a.push(new wP("#,##0_);(#,##0)"));a.push(new wP("#,##0_);[Red](#,##0)"));a.push(new wP("#,##0.00_);(#,##0.00)"));a.push(new wP("#,##0.00_);[Red](#,##0.00)"));a.push(new wP("$#,##0_);($#,##0)"));a.push(new wP("$#,##0_);[Red]($#,##0)"));a.push(new wP("$#,##0.00_);($#,##0.00)"));a.push(new wP("$#,##0.00_);[Red]($#,##0.00)"));a.push(new wP("@"));a.push(new wP("0%"));a.push(new wP("0.00%"));
a.push(new wP("0.00E+00"));a.push(new wP("##0.0E+0"));a.push(new wP("# ?/?"));a.push(new wP("# ??/??"));a.push(new wP('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new wP('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new wP('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new wP('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};KQd.prototype.t2=function(){var a=new ev;a.setType(2);X(a,3,1);var b=this.input.getValue();X(a,2,b);return a};function J2(a,b){Xk.call(this,b,new LQd(a))}x(J2,Xk);p=J2.prototype;p.$f=function(a,b,c){J2.oa.$f.call(this,a,b,c);a.Rb()&&this.Rb()&&a.getParent()==this&&MQd(this)};p.Ja=function(){J2.oa.Ja.call(this);MQd(this)};p.Tc=function(a){J2.oa.Tc.call(this,a);MQd(this)};p.removeChild=function(a,b){a=J2.oa.removeChild.call(this,a,b);MQd(this);return a};p.Un=function(a,b){a=J2.oa.Un.call(this,a,b);MQd(this);return a};
p.Cj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Pk(this);if(c){b=39==b;this.re()&&(b=!b);c=c.getElement();c=Ta(c.parentNode.childNodes,c);var d=(d=(d=Pk(this))?lda(d.getElement(),NQd):null)?Ta(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=OQd(this,e);b?b=OQd(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Uaa(this.Uq()+b);b=!0}else b=!1}b=!b}return b?J2.oa.Cj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function OQd(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function MQd(a){var b,c=a.Sd(),d=a.cd(),e=mb(Yd("div",NQd,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.va().Da("DIV",NQd),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.cd();k++)a.Zc(k)instanceof Wk?(d.push(new PQd(b,k,!0)),b=k+1):a.Zc(k)instanceof Rk&&(0==k?h=!0:(a.Zc(k-1),d.push(new PQd(b,k-1,!1)),b=k));k=a.cd();0<d.length&&Sa(d).end!=k-1&&d.push(new PQd(b,k-1,!1));b=h;h=a.cd();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.cd()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else QQd(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.cd();f++){for(;f>c[d];)++d;b=a.Zc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Wk?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function QQd(a,b,c){function d(a){return a.end-a.start-(a.iGb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;hb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,hb(a,l,1))}}function PQd(a,b,c){this.start=a;this.end=b;this.iGb=c}function LQd(a){Vk.call(this);this.D=a}x(LQd,Vk);var NQd="docs-multi-menu-col";function RQd(a){A.call(this);this.C=a}x(RQd,A);RQd.prototype.create=function(){return new J2(this.C)};function SQd(a,b){G2.call(this,a);this.qa=new M;this.H=new TQd;this.F=new M;a=(new RQd(3)).create();a.Ia(new Rk("Date"),!0);a.Ia(new Sk("Day","DAY_TOKEN"),!0);a.Ia(new Sk("Month","MONTH_TOKEN"),!0);a.Ia(new Sk("Year","YEAR_TOKEN"),!0);a.Ia(new Rk("Time"),!0);a.Ia(new Sk("Hours","HOURS_TOKEN"),!0);a.Ia(new Sk("Minutes","MINUTES_TOKEN"),!0);a.Ia(new Sk("Seconds","SECONDS_TOKEN"),!0);a.Ia(new Sk("Milliseconds","MILLIS_TOKEN"),!0);a.Ia(new Sk("AM/PM","AM_PM_TOKEN"),!0);a.Ia(new Rk("Duration"),!0);a.Ia(new Sk("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Ia(new Sk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ia(new Sk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new vTb(a);this.C=b}x(SQd,G2);p=SQd.prototype;p.Da=function(){var a=N(AQd,{i_:Oi(this,"nfd-icwr"),eW:Oi(this,"nfd-a")});this.Lb(a)};
p.Ja=function(){SQd.oa.Ja.call(this);J(this.getElement(),"nfd-date-time-input");var a=Qi(this,"nfd-icwr"),b=this.qa;b.qb(a);b.Ud(this);b.Ia(this.L,!0);J(this.L.getElement(),"nfd-date-time-menu-button");J(this.L.zc().getElement(),"nfd-date-time-menu");Ph(this.L.Pa(),"Add a date or time format");b.Ia(this.H,!0);Mc||J(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ia(a,!0);gi(a.getElement(),"display","inline");this.getHandler().V(this,"vf",Ba(this.AUa,"left")).V(this,"zf",Ba(this.vIa,"left")).V(this,
"Af",Ba(this.vIa,"right")).V(this,"Bf",Ba(this.gJa,"left")).V(this,"Cf",Ba(this.gJa,"right")).V(this,"yf",Ba(this.AUa,"right")).V(this.L,"action",this.hob)};p.UCa=function(){this.qa.getElement().focus()};
p.hN=function(a){this.Ec(a.clone());var b=this.F;b.Ed(!0);ye(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Al());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?ye(this.H.getElement(),d[2]):(e=b.Zc(b.cd()-1),d=d[2],ye(e.fA.getElement(),Ce(e.fA.getElement())+d)):UQd(this,e).fb(d[1])}0<b.cd()&&b.Zc(b.cd()-1).oy.getElement().focus()};
p.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.cd();b++)a+=this.F.Zc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Ub(e,"["),e=Ub(e,"]")):c=!0}b+=e}return b};p.hob=function(a){a=a.target.getValue();UQd(this,a).oy.getElement().focus()};
function UQd(a,b){wQd(a,!1);switch(b){case "DAY_TOKEN":var c=VQd(a);break;case "MONTH_TOKEN":c=WQd(a);break;case "YEAR_TOKEN":c=XQd(a);break;case "HOURS_TOKEN":c=YQd();break;case "MINUTES_TOKEN":c=ZQd();break;case "SECONDS_TOKEN":c=$Qd();break;case "MILLIS_TOKEN":c=aRd();break;case "AM_PM_TOKEN":c=bRd(a);break;case "ELAPSED_HOURS_TOKEN":c=cRd();break;case "ELAPSED_MINUTES_TOKEN":c=dRd();break;case "ELAPSED_SECONDS_TOKEN":c=eRd()}b=c;b.Ia(new Wk,!0);b.Ia(new Sk("Delete"),!0);c=new fRd(c,"");a.F.Ia(c,
!0);return c}p.AUa=function(a,b){b=b.target;if(b instanceof TQd){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Zc(Si(this.F,b)+1),!b))return}a=Ce(b.fA.getElement());var c=b.getParent(),d=Si(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=Ce(b),ye(b,c+a),gRd(this.H,c.length)):(d--,b=c.Zc(d),c=Ce(b.fA.getElement()),ye(b.fA.getElement(),Ce(b.fA.getElement())+a),gRd(b.fA,c.length))};
p.gJa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Zc(Si(this.F,b)+a))&&a.oy.getElement().focus()};p.vIa=function(a,b){var c="left"==a?-1:0;(b=this.F.Zc(Si(this.F,b.target)+c))||"left"!=a?b&&(b=b.fA):b=this.H;c=Ce(b.getElement()).length;gRd(b,"left"==a?c:0)};function fRd(a,b){M.call(this);this.oy=new $L("",a);this.Ia(this.oy,!0);this.fA=new TQd(b);this.Ia(this.fA,!0)}x(fRd,M);p=fRd.prototype;
p.Ja=function(){fRd.oa.Ja.call(this);gi(this.getElement(),"display","inline-block");this.oy.$e(0);this.C=new tk(this.oy.getElement());this.Ba(this.C);this.getHandler().V(this.oy,"action",this.d_b).V(this.C,"key",this.e_b)};p.d_b=function(){this.oy.vA();this.oy.Ze().kb()||this.dispatchEvent("yf")};p.e_b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("yf"));break;case 37:a.preventDefault();this.dispatchEvent("zf");break;case 39:a.preventDefault(),this.dispatchEvent("Af")}};
p.toString=function(){return this.oy.Ze().kb()+this.fA.toString()};p.fb=function(a){this.oy.fb(a)};function TQd(a){M.call(this);this.C=a||""}x(TQd,M);p=TQd.prototype;p.Da=function(){var a=fe("SPAN");ae(a,{contentEditable:!0});ye(a,this.C);var b=a.style;Jc&&!Tc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Mc?"-moz-pre-wrap":"pre-wrap";this.Lb(a)};
p.Ja=function(){TQd.oa.Ja.call(this);var a=new tk(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.f_b).V(this.getElement(),"paste",this.g_b)};function gRd(a,b){if(0==Ce(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=oK(c,b);a.getElement().focus();b.select()}}
p.f_b=function(a){var b=Be(this.getElement()),c=eK(),d=Ce(this.getElement()).length,e=c?0==c.vh()&&0==c.jn():Jb(Yb(b));b=c?c.vh()==d&&c.jn()==d:Jb(Yb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("vf"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("yf"));break;case 40:this.dispatchEvent("wf");break;case 38:this.dispatchEvent("xf");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("Bf"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Cf"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Lb(Ce(this.getElement())).replace(/"/g,'"\\""');return 0==Yb(a).length?"":'"'+a+'"'};p.g_b=function(){var a=v(function(){ye(this.getElement(),Ce(this.getElement()))},this);aj(a)};
function VQd(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new H2(Ba(b,e),a,d));d=new Xk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function WQd(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new H2(Ba(b,e),a,d));d=new Xk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function XQd(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new H2(Ba(b,e),a,d));d=new Xk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function YQd(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function ZQd(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function $Qd(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function aRd(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function bRd(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new H2(Ba(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new H2(Ba(b,e),a,d));d=new Xk;for(e=0;e<c.length;e++)d.Ia(c[e],!0);return d}
function cRd(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function dRd(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function eRd(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new H2(Ba(a,d),e,c));c=new Xk;for(d=0;d<b.length;d++)c.Ia(b[d],!0);return c};function hRd(a){E2.call(this,a);Jp(this,"Custom date and time formats")}x(hRd,E2);p=hRd.prototype;p.cSa=Pe;p.pY=n(11175.5628472222);p.isEmpty=function(){return Jb(Wu(this.t2(),2))};p.hf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Wu(this.t2(),2))};p.aha=function(){return new SQd("Custom date time format",11175.5628472222)};p.t2=function(){return iRd(this.input.getValue())};
p.B6=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.pY(),c.Al());c.D=d}b=jRd(this);pb(b);for(c=0;c<b.length;c++)a.push(new wP(iRd(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.pY(),b[c])));return a};
function jRd(a){var b=ks,c=Wa(b.DATEFORMATS,function(a){return kRd(a)},a),d=Wa(b.TIMEFORMATS,function(a){return kRd(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;pb(b);a=Wa(b,function(a){return kRd(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function kRd(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Mb(a.join(""))}function iRd(a){var b=new ev;b.setType(7);X(b,3,1);X(b,2,a);return b};function lRd(a,b){this.D=a;this.C=b}lRd.prototype.getUrl=g("D");lRd.prototype.getTitle=g("C");function mRd(a,b,c,d,e,f){vr.call(this,a,b,"domain",d,e,f);this.J=c}x(mRd,vr);mRd.prototype.C=function(){var a=mRd.oa.C.call(this);a.domainName=this.J;return jc(a,mGa)};HGa.set("domain",function(a){return new mRd(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new mRd("","DEFAULT","",!0);function nRd(){};function oRd(a){for(var b="",c=a.HTb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.GTb[f.Eh()],k=f.getLabel();f=f.$Gb;f=P('<div id="'+Q(h)+'" tabindex="0" role="link" class="'+Q("ess-button")+'" aria-label="'+Q(k)+'"><div class="'+Q("ess-icon")+" "+Q(f)+'"></div></div>');b+=f}return P(b)};function pRd(a,b){M.call(this,b);this.D=a||[];this.F=[];this.C=null}x(pRd,M);p=pRd.prototype;p.le=!0;p.gfa=!1;p.HP=null;p.kBa=!1;p.$a=function(a,b){this.le=a;this.gfa=b;if(this.kBa){b=this.va();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.HP.pra+"-"+d.Eh()),f=a;Vh(e,"ess-button",f);Vh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();wj(e,f,d)}}};
p.Da=function(){this.Lb(this.Ab.createElement("SPAN"));var a={};a.pra=Oi(this,"service");a.HTb=this.D;this.HP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Eh()]=this.HP.pra+"-"+d.Eh();a.GTb=b;this.HP=a;oq(this.getElement(),oRd,this.HP);this.kBa=!0};
p.zRb=function(a){if(this.le){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.gfa)this.dispatchEvent(new qRd(new rRd(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={BIc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Lo(b,a))&&a.focus()}}};
p.Ja=function(){this.$a(this.le,this.gfa);for(var a=this.va(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.HP.pra+"-"+d.Eh());b.Cg(e,pf,v(this.zRb,this,d))}};p.Ha=function(){pRd.oa.Ha.call(this);delete this.F;delete this.D;this.C=null};function qRd(a,b){D.call(this,"Df",b);this.context=a}x(qRd,D);function rRd(){}x(rRd,nRd);function K2(a,b,c,d){this.C=a;this.F=b;this.D=c;this.$Gb=d;this.H=sRd++}var sRd=0;K2.prototype.Eh=g("H");K2.prototype.getName=g("F");K2.prototype.getLabel=g("D");function tRd(){K2.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(tRd,K2);tRd.prototype.getUrl=function(a){var b=Wa(a,function(a){return a.getTitle()});a=Wa(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Nb(a.join(","))+"&t="+Nb(b.join(","))};function uRd(){K2.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(uRd,K2);uRd.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Nb(a[0].getUrl())};function vRd(){K2.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(vRd,K2);vRd.prototype.getUrl=function(a){a=Wa(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Nb(a.join("\n"))};function wRd(){K2.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(wRd,K2);wRd.prototype.getUrl=function(a){for(var b=oa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Nb(a)};function L2(a){M.call(this,a)}x(L2,M);function xRd(a){a.dispatchEvent(new D("Ef"))}L2.prototype.tY=function(){return{}};L2.prototype.QK=Re;L2.prototype.jra=sa;function yRd(a){M.call(this,a)}x(yRd,M);yRd.prototype.F=Re;yRd.prototype.H=sa;yRd.prototype.J=sa;function zRd(a,b,c){b=c||b;c='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+aOd(a.locale)+'&answer=183965">Learn more</a>');c=c+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';
c+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';c+="Embed";c+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+Q(a.k9a)+'" readonly="readonly" aria-label="';c+=Bq("Link to published document.");c+=" "+Q(a.yPa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';
c+="Or share this link using:";c+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';c+=Bq("HTML embed code of published document.");c+=" "+Q(a.yPa)+'">'+FEa(a.cdb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+O(Fq({id:"pub-dialog-publish-link-button",
style:2,value:a.yRb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+O(Br({Ht:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));c+="Published content & settings";c+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+O(Fq({id:"pub-dialog-publish-button",value:a.wRb},b))+'<div class="pub-dialog-checkbox-container">';
a.DHb&&(c+=O(Xs({id:"pub-dialog-dom-signin-req",checked:a.$s,disabled:a.hK},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.hK?' class="pub-dialog-disabled-text"':"")+">",d="Require viewers to sign in with their "+(O(a.domain)+" account"),c+=d,c+="</label><br>");a.SP&&(c+=O(Xs({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">',c+="Automatically republish when changes are made",
c+="</label>");c+="</div></div></div></div></div>";return P(c)};function M2(a,b,c,d,e,f,h,k,l,m){Ts.call(this);this.xb=a||"";this.Fe=b;this.dd=c;this.Uc=d;this.Hc=l||"/publishsettings";this.C=new ARd(e);this.Hb=new pRd([new uRd,new vRd,new tRd,new wRd]);this.Ia(this.Hb);this.Aa=new Gq(null,this.va());this.Ia(this.Aa);this.R=new Gq(null,this.va());this.Ia(this.R);this.jb=new Ys(void 0,this.va());this.Ia(this.jb);this.Ea=new Ys(void 0,this.va());this.Ia(this.Ea);this.pb=0;this.Qb=new BRd;this.Ia(this.Qb);this.Eb=this.Jb=null;this.J=f||new L2;this.Ia(this.J);this.F=
h||new L2;this.Ia(this.F);this.eb=k||new yRd;this.Ia(this.eb);this.O=this.L=null;this.Na=new tr(void 0,CRd,this.va(),2);this.Ba(this.Na);this.ue=this.qd=null;this.Oe=m||new M;this.fc=this.sb=this.Pb=null;this.Ci=!0}x(M2,Ts);var CRd="Press "+((Qc?"\u2318+C":"Ctrl+C")+" to copy.");p=M2.prototype;p.ld=function(){M2.oa.ld.call(this);this.Na.ld()};p.show=function(){DRd(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){M2.oa.setVisible.call(this,a);var b=Je(this.va());a?this.getHandler().V(b,"resize",this.ld):this.getHandler().Oc(b,"resize",this.ld)};
p.Da=function(){M2.oa.Da.call(this);var a=this.va(),b=N(zRd,{DHb:!!this.C.domain,SP:this.C.SP(),$s:this.C.$s,domain:this.C.C,hK:this.C.hK,wRb:ERd(this),yRb:N2(this,FRd(this))?"Published":"Publish",k9a:this.C.Gk?GRd(this,this.J.tY()):"",cdb:this.C.Gk?HRd(this,this.F.tY()):"",locale:"en",yPa:CRd});a.appendChild(this.Sb(),b);Jp(this,"Publish to the web");Xp(this,null);J(this.Sb(),"pub-dialog-content")};
p.Ja=function(){var a=this.va(),b=a.getElement("pub-dialog-sharing-services-links");this.Hb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Pb=a.getElement("pub-dialog-links-notice");this.Oe.render(this.Pb);b=a.getElement("pub-dialog-published-content");this.eb.render(b);M2.oa.Ja.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.jb.qb(c),Ws(this.jb,a.getElement("pub-dialog-dom-signin-req-label")),
b.V(this.jb,"change",this.BWb));this.C.SP()&&(this.Ea.qb(a.getElement("pub-dialog-auto-publish-checkbox")),Ws(this.Ea,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.V(this.Ea,"change",this.xWb));this.Jb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Eb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");sr(this.Na,this.L);this.Qb.qb(a.getElement("pub-dialog-links-tab-bar"));this.qd=a.getElement("pub-dialog-sharing-services");
this.ue=a.getElement("pub-dialog-status-info");this.Aa.qb(a.getElement("pub-dialog-publish-link-button"));this.R.qb(a.getElement("pub-dialog-publish-button"));this.fc=new eN("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Gk);this.Ba(this.fc);b.V(this.Qb,"select",this.mBb).V(this.L,"focus",this.TQa).V(this.O,"focus",this.TQa).V(this.R,"action",this.ARb).V(this.getElement(),"keyup",this.y8a).V(this.J,"Ef",this.Xsa).V(this.F,"Ef",this.Xsa).V(this.Aa,"action",this.gzb).V(this.eb,"Ff",
this.hzb).V(this.fc,"toggle",this.ld);IRd(this)};function IRd(a){if(a.Rb()){var b=a.va(),c=a.C.Gk,d=a.C.hK;a.eb.H(a.C.Om);a.jb.$a(!d);a.R.setContent(ERd(a));a.R.$a(a.C.Gk||!a.C.Om||!a.C.Om.isEmpty());a.C.SP()&&a.Ea.Dc(a.C.zw);a.Xsa();b=b.$h("pub-dialog-state-publishing");z(b,function(a){L(a,c)});ye(a.ue,c?"This document is published to the web.":"This document is not published to the web.");a.ld()}}p.y8a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function JRd(a,b){var c=window.location.href,d=ol(c);c=rl(c);var e=Sb(c,"/"+a.Uc+"/")?"/"+a.Uc:"";a.C.$s&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.xb;b=mLa.test(b)?b:Gl("/d/"+a,b);return nl(c,f,h,d,Gl(e,b))}
p.Xsa=function(){var a=this.J.QK();if(a=N2(this,a)){var b=this.C.Gk?GRd(this,this.J.tY()):"";this.L.value=b;this.Hb.F=[new lRd(b,this.Fe)]}L(this.L,a);L(this.qd,a&&!this.C.hK);a=this.F.QK();if(a=N2(this,a))this.O.value=this.C.Gk?HRd(this,this.F.tY()):"";L(this.O,a);a=N2(this,FRd(this));L(this.Pb,a);this.Aa.$a(!a);this.Aa.setContent(N2(this,FRd(this))?"Published":"Publish")};
p.mBb=function(a){a=a.target;this.va();tGa(this.Na);"pub-dialog-link-tab"==a.getId()?(this.pb=0,L(this.Jb,!0),L(this.Eb,!1),sr(this.Na,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.pb=1,L(this.Jb,!1),L(this.Eb,!0),sr(this.Na,this.O));IRd(this)};p.TQa=function(a){aj(function(){a.target.select()},0)};p.BWb=function(){this.C.Gk?KRd(this,2,!1):this.C.$s=!this.C.$s};p.xWb=function(){this.C.Gk?KRd(this,0,!1):this.C.zw=!this.C.zw};function ERd(a){return a.C.Gk?"Stop publishing":"Start publishing"}
function DRd(a,b){Lr(en(a.dd.jf(a.Hc),"id",a.xb),v(function(a){this.C.Gk=!!Nt(a,"published");this.C.$s=!!Nt(a,"requireSignin");this.C.hK=!!Nt(a,"domainClosed");this.C.domain=jCc(a,"domain");this.C.C=jCc(a,"domainDisplay");this.C.zw=!Number(Nt(a,"revision"));this.C.Om=this.yEa(a.ef());this.C.F=jCc(a,"publishedDocumentId");b()},a)).He()}p.yEa=Re;p.eEa=Re;function LRd(a){return{zw:a.C.zw,Gk:a.C.Gk,$s:a.C.$s,Om:a.C.Om}}
function KRd(a,b,c){c=t(c)?c:!0;var d=LRd(a);switch(b){case 0:d.zw=!d.zw;break;case 1:d.Gk=!d.Gk;break;case 2:d.$s=!d.$s;break;default:throw Error("Unknown toggle op: "+b);}d.Gk||(d.Om=a.eEa());MRd(a,d,c)}
function MRd(a,b,c){NRd(a,!1);zt(Lr(At($s(en(a.dd.jf(a.Hc),"id",a.xb),ORd(a,b)),2),v(function(){this.C.zw=b.zw;this.C.Gk=b.Gk;this.C.$s=b.$s;this.C.Om=b.Om;this.C.Gk&&this.C.Om&&(N2(this,this.J.QK())||this.J.jra(this.C.Om),N2(this,this.F.QK())||this.F.jra(this.C.Om));NRd(this,!0);IRd(this);if(c&&this.C.Gk)switch(this.pb){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.pb);}},a)),v(function(){fMa("An error occurred while saving publishing settings.",
void 0,this.Rb()?this:void 0);NRd(this,!0);IRd(this)},a)).He()}function ORd(a,b){var c={id:a.xb,requireSignin:b.$s,published:b.Gk};a.C.SP()&&!b.zw&&(c.revision=a.C.D);b.Om&&(a=PRd(b.Om),Cc(c,a));return c}function NRd(a,b){for(var c=[a.Ea,a.R,a.Aa,a.jb],d=0;d<c.length;d++){var e=c[d];!b&&e.Lm()&&(a.sb=e);e.$a(b)}b&&a.sb&&(a.isVisible()&&a.sb.isVisible()&&(c=a.sb.getElement())&&c.focus(),a.sb=null);a.eb.J(b)}
p.ARb=function(a,b){if(b||window.confirm(this.C.Gk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.R.setContent("Saving..."),KRd(this,1)};function FRd(a){switch(a.pb){case 0:return a.J.QK();case 1:return a.F.QK();default:throw Error("Cannot handle selected link type "+a.pb);}}
p.gzb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=FRd(this),b=LRd(this);b.Gk=!0;a&&(b.Om&&this.C.Gk?b.Om=QRd(b.Om,a):b.Om=a);this.Aa.setContent("Publishing...");MRd(this,b,!0)}};p.hzb=function(){var a=this.eb.F();if(this.C.Gk)if(a&&a.isEmpty())KRd(this,1);else{var b=LRd(this);b.Om=a;MRd(this,b)}else this.C.Om=a,IRd(this)};function N2(a,b){var c;(c=a.C.Gk)&&!(c=!b||!a.C.Om)&&(a=a.C.Om,c=a.F||!b.F&&Za(b.D.Ad(),a.v9,a)&&Za(b.C,a.k9,a));return c}
function ARd(a){this.D=a;this.hK=this.$s=this.Gk=!1;this.zw=!0;this.F=this.C=this.domain=""}ARd.prototype.SP=function(){return!!this.D};function BRd(){BS.call(this)}x(BRd,BS);BRd.prototype.Cj=function(a){return a.keyCode&&27==a.keyCode?!1:BRd.oa.Cj.call(this,a)};function RRd(a,b,c,d){this.F=a;this.Hh=b;this.C=c;this.D=d}function SRd(a,b){return new RRd(!1,null,new TRd(a,b||"interactive"),null)}function TRd(a,b){this.id=a;this.format=b};function O2(a,b,c){this.F=a;this.D=new ME(b);this.C=c}p=O2.prototype;p.v9=function(a){return this.F||this.D.contains(a)};function URd(a,b){return Ya(a.C,function(a){return a.id==b.id})}p.k9=function(a){return this.F||this.D.contains(a.Hh)||URd(this,a)};function VRd(a,b){a.C=Va(a.C,function(a){return a.Hh!=b})}function WRd(a,b){URd(a,b)&&(a.C=Va(a.C,function(a){return a.id!=b.id}))}
function QRd(a,b){var c=a.F||b.F;if(c)return new O2(c,[],[]);var d=a.clone();z(b.D.Ad(),function(a){d.D.contains(a)||(d.D.add(a),VRd(d,a))});z(b.C,function(a){d.k9(a)||d.C.push(a)});return d}function PRd(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Ad().join(","),charts:Wa(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&cb(this.C)};p.clone=function(){return new O2(this.F,this.D.Ad(),mb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&wb(this.C,a.C,function(a,c){return a.id==c.id&&a.Hh==c.Hh})};function XRd(a,b){this.id=a;this.Hh=b};function YRd(a,b,c,d){M.call(this,void 0);this.C=c||new RRd(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new $L("",ZRd(a,b));Rq(this.D,!0);this.Ia(this.D,!0);a=new Xk;a.Ia(new Sk("Interactive","interactive"),!0);a.Ia(new Sk("Image","image"),!0);this.H=new $L("",a);this.Ia(this.H,!0);a=new Xk;a.Ia(new Sk("Web page","html"),!0);a.Ia(new Sk("Comma-separated values (.csv)","csv"),!0);a.Ia(new Sk("Tab-separated values (.tsv)","tsv"),!0);a.Ia(new Sk("PDF document (.pdf)","pdf"),!0);a.Ia(new Sk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ia(new Sk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new $L("",a);this.Ia(this.F,!0);$Rd(this)}x(YRd,L2);var aSd=["xlsx","ods"],bSd=["csv","tsv"];
function ZRd(a,b){var c=new Xk;c.Ia(new Sk("Entire Document",new cSd("entireDocument",null)),!0);c.Ia(new Wk,!0);var d=fvb(b);z(a.D,function(a){c.Ia(new Sk(a.pe(),new cSd("sheet",a.Ib())),!0);if(a=d[a.Ib()])for(var b={},e=0;e<a.length;b={lW:b.lW},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.lW=new Sk("",new cSd("chart",BH(k))),Mub(k).then(function(a){return function(b){a.lW.Fv(b.getTitle())}}(b)),c.Ia(b.lW,!0),J(b.lW.Sb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=YRd.prototype;
p.Ja=function(){YRd.oa.Ja.call(this);J(this.getElement(),"pub-dialog-link-options-container");J(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");J(this.D.Sb(),"pub-dialog-link-options-document-part-menu-button-content");J(this.D.zc().getElement(),"pub-dialog-link-options-document-part-menu");Ph(this.D.Pa(),"Sheet or chart selection");Ph(this.H.Pa(),"Chart format");Ph(this.F.Pa(),"Sheet format");this.getHandler().V(this.D,"change",this.gpb).V(this.H,"change",this.Zlb).V(this.F,
"change",this.YBb).V(this.D,"afterhide",function(a){a.stopPropagation()}).V(this.H,"afterhide",function(a){a.stopPropagation()}).V(this.F,"afterhide",function(a){a.stopPropagation()})};p.gpb=function(){var a=this.D.Ze().kb();switch(a.type){case "entireDocument":this.C=new RRd(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id+"";var b=this.C.D;b&&!dSd(this,a,b)&&(b=null);this.C=new RRd(!1,a,null,b||"html");break;case "chart":this.C=SRd(a.id,this.C.C?this.C.C.format:null)}$Rd(this);xRd(this)};
p.Zlb=function(){var a=this.H.Ze().kb();this.C.C&&(this.C.C.format=a,xRd(this))};p.YBb=function(){var a=this.F.Ze().kb();this.C.D=a;xRd(this)};
function $Rd(a){var b=mb(a.D.qj.C);b=$a(b,function(a){a=a.kb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Hh&&a.id==this.C.Hh;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);er(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.fb(a.C.C.format);L(a.F.getElement(),a.J&&!b);b||(eSd(a),a.F.fb(a.C.D))}
function eSd(a){for(var b=a.F.zc(),c=0;c<b.Mh();c++){var d=b.We(c),e=d.getValue();d.$a(null==a.C.Hh||dSd(a,a.C.Hh,e))}}function dSd(a,b,c){if(bb(aSd,c))return!1;a=QF(a.O,b);return null!=a&&1==a.getSheetType()&&bb(bSd,c)?!1:!0}p.tY=g("C");p.QK=function(){if(this.C.F)return new O2(!0,[],[]);if(null!=this.C.Hh)return new O2(!1,[this.C.Hh],[]);var a=this.L.C(this.C.C.id);a=new XRd(this.C.C.id,a.Ib());return new O2(!1,[],[a])};
p.jra=function(a){if(!a.F){var b=a.D.Ad();0<b.length?this.C=new RRd(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=SRd(a[0].id)));$Rd(this)}};function cSd(a,b){this.type=a;this.id=b};function P2(a,b){Qq.call(this,void 0,void 0,new ZL,void 0);this.Ea=a;this.ma=b;this.F=new O2(!0,[],[]);this.R=!1;this.H=new cN("Entire Document");this.yd(this.H);this.yd(new Wk);fSd(this);Rq(this,!0);gSd(this)}x(P2,Qq);function fSd(a){var b=fvb(a.ma);z(a.Ea.D,function(c){var d=new cN(c.pe(),c);a.yd(d);(c=b[c.Ib()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new cN("",b);Mub(b).then(function(a){c.Fv(a.getTitle())});a.yd(c);J(c.Sb(),"pub-dialog-published-content-chart-menu-item")}})})}
P2.prototype.Ja=function(){P2.oa.Ja.call(this);J(this.getElement(),"pub-dialog-published-content-menu-button");J(this.Sb(),"pub-dialog-published-content-menu-button-content");J(this.zc().getElement(),"pub-dialog-published-content-menu");this.getHandler().V(this,"afterhide",function(a){a.stopPropagation()})};
P2.prototype.Gs=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.kb(),b instanceof ND?(b=b.Ib(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),VRd(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),VRd(a,b)))):(b=new XRd(BH(b),b.Ib()),a?(a=this.F,a.k9(b)||a.C.push(b)):WRd(this.F,b));this.R=!0;gSd(this)};P2.prototype.Nd=function(a,b){P2.oa.Nd.call(this,a,b);!a&&this.R&&(this.R=!1,this.dispatchEvent(new D("Ff")))};
function gSd(a){var b=a.F.F;a.H.Dc(b);z(eCc(a.zc()),function(c){var d=c.kb();d&&(d instanceof ND?(c.Dc(a.F.v9(d.Ib())),c.$a(!b)):(d=new XRd(BH(d),d.Ib()),c.Dc(a.F.k9(d)),c.$a(!a.F.v9(d.Hh))))});hSd(a)}
function hSd(a){if(a.F.F)a.setContent("Entire Document");else{var b=Va(a.Ea.D,v(function(a){return this.F.v9(a.Ib())},a)),c=Wa(b,function(a){return a.pe()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.ma.C(d[e].id);f&&b.push(Mub(f))}Vea(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.fDa&&d.push(f.value.getTitle())}b=lb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function Q2(a,b){M.call(this,void 0);this.C=new P2(a,b);this.Ia(this.C,!0);this.D=!1}x(Q2,yRd);Q2.prototype.Ja=function(){Q2.oa.Ja.call(this);J(this.getElement(),"pub-dialog-published-content-container")};Q2.prototype.F=function(){return this.C.F};Q2.prototype.H=function(a){var b=this.C;b.F=a.clone();gSd(b)};Q2.prototype.J=function(a){!a&&this.C.Lm()&&(this.D=!0);this.C.$a(a);a&&this.D&&(this.Rb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function iSd(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+aOd(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return P(b+a+"</div>")};function jSd(a,b,c,d,e,f,h){var k=null!=h?SRd(h):null;h=new YRd(c,d,k,!0);k=new YRd(c,d,k,!1);M2.call(this,a,b,e,O5a,f,h,k,new Q2(c,d),"/publishingsettings",new kSd);this.rf=c;this.wc=d}x(jSd,M2);
jSd.prototype.yEa=function(a){if(a.entireDocument)return new O2(!0,[],[]);var b=a.charts||"";a=Va((a.sheets||"").split(","),function(a){return null!=QF(this.rf,a)},this);b=Wa(b.split(","),function(a){return parseInt(a,10)});b=Va(b,v(function(a){return!!this.wc.C(a)},this));b=Wa(b,function(a){var b=this.wc.C(a);return new XRd(a,b.Ib())},this);return new O2(!1,a,b)};jSd.prototype.eEa=function(){return new O2(!0,[],[])};
function GRd(a,b){if(b.F||null!=b.Hh){var c="html"==b.D;a=JRd(a,c?"/pubhtml":"/pub");null!=b.Hh&&(a=vl(a,"gid",b.Hh,"single","true"));c||(a=vl(a,"output",b.D))}else a=vl(JRd(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function HRd(a,b){var c=GRd(a,b);if(b.F||null!=b.Hh)c=vl(c,"widget","true","headers","false");a=b.C?(a=a.wc.C(b.C.id))?a.bd():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Pb(c)+'"></iframe>'}function kSd(){}x(kSd,M);kSd.prototype.Da=function(){this.Lb(N(iSd,{locale:"en"}))};function lSd(){A.call(this)}x(lSd,Cz);p=lSd.prototype;p.teb=function(){return rQd};p.Peb=function(){return JPd};p.KLb=function(a,b,c,d){var e=new Ar;a=new cq(a,b,c,d,void 0,!0,void 0);hq(a,"ok");b=v(e.qb,e);a.rna=b;a.Ba(e);a.Ci=!0;a.u7=zda(Jb);return a};p.wgb=function(){return CPd};p.Q5a=function(a,b,c,d,e,f,h){return new lQd(a,b,c,d,e,f,h,void 0)};p.Zeb=function(){return LOd};p.VDa=function(){return aPd};p.nfb=function(){return kPd};p.Bgb=function(){return D2};p.Agb=function(){return jSd};
p.hgb=function(){return sPd};p.zgb=function(){return MPd};p.Teb=function(){return KQd};p.xgb=function(){return HQd};p.ygb=function(){return hRd};p.Seb=function(){return s2};p.hfb=function(){return dOd};p.bhb=function(){return eOd};Jz("dialogs",lSd);
